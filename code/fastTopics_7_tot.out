
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 7"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-7 Poisson NMF to 101000 x 18482 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.161620277e+09 +1.29694807e+09 1.44e+05 1.1e+02 7.8e-01 0.761 0.571 0.00
   2 -1.146209585e+09 +1.26612669e+09 1.02e+05 5.3e+01 2.4e+00 0.780 0.818 0.00
   3 -1.140568619e+09 +1.25484476e+09 2.21e+04 7.6e+01 2.3e+00 0.772 0.671 0.00
   4 -1.137158589e+09 +1.24802470e+09 3.95e+03 7.1e+01 2.0e+00 0.775 0.671 0.00
   5 -1.134887868e+09 +1.24348326e+09 8.90e+03 6.2e+01 1.4e+00 0.779 0.679 0.00
   6 -1.133429110e+09 +1.24056574e+09 2.90e+03 4.2e+01 1.3e+00 0.782 0.681 0.00
   7 -1.132461599e+09 +1.23863072e+09 2.81e+03 2.4e+01 1.4e+00 0.786 0.682 0.00
   8 -1.131757364e+09 +1.23722225e+09 3.05e+03 1.3e+01 1.2e+00 0.788 0.680 0.00
   9 -1.131188846e+09 +1.23608521e+09 2.81e+03 1.3e+01 6.2e-01 0.790 0.678 0.00
  10 -1.130704172e+09 +1.23511587e+09 2.32e+03 1.1e+01 4.0e-01 0.793 0.677 0.00
  11 -1.130279415e+09 +1.23426635e+09 1.78e+03 9.8e+00 3.0e-01 0.794 0.677 0.00
  12 -1.129909805e+09 +1.23352713e+09 1.34e+03 8.3e+00 2.5e-01 0.796 0.677 0.00
  13 -1.129597279e+09 +1.23290208e+09 1.27e+03 7.0e+00 2.0e-01 0.797 0.678 0.00
  14 -1.129331938e+09 +1.23237140e+09 1.77e+03 5.8e+00 1.9e-01 0.798 0.679 0.00
  15 -1.129106593e+09 +1.23192071e+09 1.81e+03 5.6e+00 1.8e-01 0.798 0.679 0.00
  16 -1.128914914e+09 +1.23153735e+09 1.68e+03 5.4e+00 1.6e-01 0.799 0.680 0.00
  17 -1.128748412e+09 +1.23120435e+09 1.60e+03 5.3e+00 1.6e-01 0.799 0.682 0.00
  18 -1.128602341e+09 +1.23091220e+09 1.44e+03 5.0e+00 1.6e-01 0.798 0.683 0.00
  19 -1.128474286e+09 +1.23065609e+09 1.24e+03 4.5e+00 1.5e-01 0.798 0.684 0.00
  20 -1.128361031e+09 +1.23042958e+09 1.05e+03 4.0e+00 1.4e-01 0.797 0.685 0.00
  21 -1.128258638e+09 +1.23022480e+09 9.01e+02 3.6e+00 1.3e-01 0.797 0.686 0.00
  22 -1.128163943e+09 +1.23003541e+09 9.50e+03 3.1e+00 1.2e-01 0.796 0.687 0.00
  23 -1.128021806e+09 +1.22975113e+09 6.39e+03 7.1e+00 1.8e-01 0.795 0.688 0.00
  24 -1.127760833e+09 +1.22922919e+09 1.52e+03 4.8e+00 5.7e-01 0.795 0.689 0.00
  25 -1.127628458e+09 +1.22896444e+09 1.29e+03 3.9e+00 3.9e-01 0.794 0.691 0.00
  26 -1.127543868e+09 +1.22879526e+09 9.83e+02 2.9e+00 2.1e-01 0.793 0.692 0.00
  27 -1.127479558e+09 +1.22866664e+09 7.85e+02 2.8e+00 1.1e-01 0.792 0.693 0.00
  28 -1.127425064e+09 +1.22855765e+09 6.63e+02 2.9e+00 1.1e-01 0.791 0.695 0.00
  29 -1.127376319e+09 +1.22846016e+09 5.79e+02 3.0e+00 1.1e-01 0.789 0.696 0.00
  30 -1.127331850e+09 +1.22837122e+09 5.14e+02 3.1e+00 1.0e-01 0.788 0.697 0.00
  31 -1.127291158e+09 +1.22828984e+09 4.26e+02 3.2e+00 1.0e-01 0.787 0.699 0.00
  32 -1.127254319e+09 +1.22821616e+09 3.97e+02 3.1e+00 9.5e-02 0.786 0.700 0.00
  33 -1.127221038e+09 +1.22814960e+09 3.69e+02 3.1e+00 9.0e-02 0.785 0.701 0.00
  34 -1.127191238e+09 +1.22809000e+09 3.49e+02 3.0e+00 8.6e-02 0.784 0.703 0.00
  35 -1.127164820e+09 +1.22803716e+09 3.52e+02 2.9e+00 8.2e-02 0.783 0.704 0.00
  36 -1.127141605e+09 +1.22799073e+09 3.49e+02 2.8e+00 7.8e-02 0.781 0.705 0.00
  37 -1.127121329e+09 +1.22795018e+09 3.46e+02 2.7e+00 7.5e-02 0.781 0.706 0.00
  38 -1.127103694e+09 +1.22791491e+09 3.41e+02 2.5e+00 7.0e-02 0.780 0.707 0.00
  39 -1.127088428e+09 +1.22788438e+09 3.33e+02 2.4e+00 6.5e-02 0.779 0.708 0.00
  40 -1.127075313e+09 +1.22785815e+09 3.25e+02 2.2e+00 6.0e-02 0.778 0.709 0.00
  41 -1.127064308e+09 +1.22783614e+09 3.16e+02 2.1e+00 5.5e-02 0.777 0.710 0.00
  42 -1.127054969e+09 +1.22781746e+09 3.06e+02 1.9e+00 4.8e-02 0.777 0.711 0.00
  43 -1.127047315e+09 +1.22780215e+09 2.99e+02 1.7e+00 4.1e-02 0.776 0.712 0.00
  44 -1.127041007e+09 +1.22778954e+09 2.95e+02 1.5e+00 3.7e-02 0.775 0.712 0.00
  45 -1.127035749e+09 +1.22777902e+09 2.93e+02 1.3e+00 3.3e-02 0.775 0.713 0.00
  46 -1.127031317e+09 +1.22777015e+09 2.91e+02 1.2e+00 3.0e-02 0.775 0.714 0.00
  47 -1.127027542e+09 +1.22776261e+09 2.90e+02 1.0e+00 2.7e-02 0.774 0.714 0.00
  48 -1.127024293e+09 +1.22775611e+09 2.90e+02 9.4e-01 2.4e-02 0.774 0.715 0.00
  49 -1.127021471e+09 +1.22775046e+09 2.90e+02 8.3e-01 2.2e-02 0.773 0.715 0.00
  50 -1.127018997e+09 +1.22774551e+09 2.90e+02 7.4e-01 2.0e-02 0.773 0.716 0.00
  51 -1.127016810e+09 +1.22774114e+09 2.90e+02 6.6e-01 1.8e-02 0.773 0.716 0.00
  52 -1.127014865e+09 +1.22773725e+09 2.90e+02 5.9e-01 1.7e-02 0.773 0.716 0.00
  53 -1.127013120e+09 +1.22773376e+09 2.91e+02 5.2e-01 1.6e-02 0.772 0.717 0.00
  54 -1.127011542e+09 +1.22773061e+09 2.91e+02 4.7e-01 1.5e-02 0.772 0.717 0.00
  55 -1.127010104e+09 +1.22772773e+09 2.91e+02 4.2e-01 1.4e-02 0.772 0.717 0.00
  56 -1.127008786e+09 +1.22772509e+09 2.90e+02 3.7e-01 1.4e-02 0.772 0.717 0.00
  57 -1.127007573e+09 +1.22772267e+09 2.89e+02 3.6e-01 1.3e-02 0.772 0.718 0.00
  58 -1.127006450e+09 +1.22772042e+09 2.87e+02 3.5e-01 1.2e-02 0.771 0.718 0.00
  59 -1.127005407e+09 +1.22771834e+09 2.86e+02 3.5e-01 1.2e-02 0.771 0.718 0.00
  60 -1.127004436e+09 +1.22771639e+09 2.84e+02 3.4e-01 1.1e-02 0.771 0.718 0.00
  61 -1.127003529e+09 +1.22771458e+09 2.82e+02 3.3e-01 1.1e-02 0.771 0.718 0.00
  62 -1.127002685e+09 +1.22771289e+09 1.94e+02 3.2e-01 1.1e-02 0.771 0.718 0.00
  63 -1.127001923e+09 +1.22771137e+09 1.85e+02 3.0e-01 9.3e-03 0.771 0.719 0.00
  64 -1.127001240e+09 +1.22771000e+09 1.69e+02 2.5e-01 8.4e-03 0.770 0.719 0.00
  65 -1.127000625e+09 +1.22770877e+09 1.62e+02 2.2e-01 8.0e-03 0.770 0.719 0.00
  66 -1.127000071e+09 +1.22770766e+09 1.55e+02 2.1e-01 7.6e-03 0.770 0.719 0.00
  67 -1.126999582e+09 +1.22770669e+09 1.46e+02 2.0e-01 7.5e-03 0.770 0.719 0.00
  68 -1.126999149e+09 +1.22770582e+09 1.38e+02 1.9e-01 7.0e-03 0.770 0.719 0.00
  69 -1.126998764e+09 +1.22770505e+09 1.33e+02 1.8e-01 6.3e-03 0.770 0.719 0.00
  70 -1.126998420e+09 +1.22770436e+09 1.30e+02 1.7e-01 6.0e-03 0.770 0.719 0.00
  71 -1.126998113e+09 +1.22770375e+09 1.26e+02 1.6e-01 5.7e-03 0.770 0.719 0.00
  72 -1.126997836e+09 +1.22770319e+09 1.23e+02 1.5e-01 5.4e-03 0.770 0.720 0.00
  73 -1.126997586e+09 +1.22770269e+09 1.21e+02 1.4e-01 5.2e-03 0.770 0.720 0.00
  74 -1.126997360e+09 +1.22770224e+09 1.19e+02 1.3e-01 4.9e-03 0.769 0.720 0.00
  75 -1.126997155e+09 +1.22770183e+09 1.16e+02 1.3e-01 4.7e-03 0.769 0.720 0.00
  76 -1.126996968e+09 +1.22770146e+09 1.14e+02 1.2e-01 4.5e-03 0.769 0.720 0.00
  77 -1.126996798e+09 +1.22770112e+09 1.13e+02 1.2e-01 4.3e-03 0.769 0.720 0.00
  78 -1.126996641e+09 +1.22770080e+09 1.11e+02 1.1e-01 4.2e-03 0.769 0.720 0.00
  79 -1.126996497e+09 +1.22770051e+09 1.09e+02 1.1e-01 4.0e-03 0.769 0.720 0.00
  80 -1.126996363e+09 +1.22770025e+09 1.08e+02 1.0e-01 3.8e-03 0.769 0.720 0.00
  81 -1.126996240e+09 +1.22770000e+09 1.07e+02 9.7e-02 3.7e-03 0.769 0.720 0.00
  82 -1.126996125e+09 +1.22769977e+09 1.05e+02 9.3e-02 3.6e-03 0.769 0.720 0.00
  83 -1.126996018e+09 +1.22769956e+09 1.04e+02 8.9e-02 3.4e-03 0.769 0.720 0.00
  84 -1.126995919e+09 +1.22769936e+09 1.03e+02 8.6e-02 3.3e-03 0.769 0.720 0.00
  85 -1.126995826e+09 +1.22769917e+09 1.01e+02 8.3e-02 3.2e-03 0.769 0.720 0.00
  86 -1.126995738e+09 +1.22769900e+09 1.00e+02 8.2e-02 3.1e-03 0.769 0.720 0.00
  87 -1.126995656e+09 +1.22769883e+09 9.88e+01 8.1e-02 3.0e-03 0.769 0.721 0.00
  88 -1.126995578e+09 +1.22769868e+09 9.77e+01 8.0e-02 2.9e-03 0.769 0.721 0.00
  89 -1.126995505e+09 +1.22769853e+09 9.66e+01 8.0e-02 2.8e-03 0.769 0.721 0.00
  90 -1.126995435e+09 +1.22769839e+09 9.55e+01 7.9e-02 2.7e-03 0.769 0.721 0.00
  91 -1.126995370e+09 +1.22769826e+09 9.44e+01 7.8e-02 2.6e-03 0.769 0.721 0.00
  92 -1.126995307e+09 +1.22769814e+09 9.33e+01 7.7e-02 2.5e-03 0.769 0.721 0.00
  93 -1.126995247e+09 +1.22769802e+09 9.23e+01 7.6e-02 2.4e-03 0.769 0.721 0.00
  94 -1.126995191e+09 +1.22769790e+09 9.11e+01 7.5e-02 2.4e-03 0.769 0.721 0.00
  95 -1.126995137e+09 +1.22769779e+09 9.00e+01 7.4e-02 2.3e-03 0.769 0.721 0.00
  96 -1.126995085e+09 +1.22769769e+09 8.90e+01 7.3e-02 2.2e-03 0.769 0.721 0.00
  97 -1.126995036e+09 +1.22769759e+09 8.79e+01 7.2e-02 2.2e-03 0.769 0.721 0.00
  98 -1.126994989e+09 +1.22769750e+09 8.69e+01 7.1e-02 2.1e-03 0.769 0.721 0.00
  99 -1.126994944e+09 +1.22769741e+09 8.60e+01 7.0e-02 2.0e-03 0.768 0.721 0.00
 100 -1.126994901e+09 +1.22769732e+09 8.51e+01 6.9e-02 2.0e-03 0.768 0.721 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds"))
> 
> proc.time()
      user     system    elapsed 
100194.103   8558.212  48480.428 
