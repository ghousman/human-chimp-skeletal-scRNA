
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 4"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-4 Poisson NMF to 101000 x 18482 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.180226727e+09 +1.33416098e+09 2.87e+04 9.6e+01 6.3e-01 0.870 0.847 0.00
   2 -1.175762358e+09 +1.32523224e+09 2.56e+03 2.4e+01 2.7e+00 0.880 0.856 0.00
   3 -1.174347967e+09 +1.32240346e+09 2.30e+03 1.4e+01 2.0e+00 0.875 0.849 0.00
   4 -1.173832469e+09 +1.32137246e+09 6.32e+02 7.7e+00 2.4e+00 0.876 0.806 0.00
   5 -1.173665456e+09 +1.32103843e+09 8.81e+02 6.8e+00 6.1e-01 0.873 0.793 0.00
   6 -1.173584298e+09 +1.32087612e+09 8.41e+02 5.4e+00 2.2e-01 0.873 0.777 0.00
   7 -1.173533623e+09 +1.32077477e+09 7.32e+02 4.3e+00 1.7e-01 0.872 0.765 0.00
   8 -1.173497395e+09 +1.32070231e+09 4.83e+02 3.4e+00 1.3e-01 0.871 0.759 0.00
   9 -1.173469884e+09 +1.32064729e+09 2.84e+02 2.8e+00 1.1e-01 0.871 0.755 0.00
  10 -1.173448373e+09 +1.32060427e+09 1.69e+02 2.3e+00 9.2e-02 0.871 0.753 0.00
  11 -1.173431264e+09 +1.32057005e+09 1.42e+02 2.0e+00 7.5e-02 0.871 0.752 0.00
  12 -1.173417448e+09 +1.32054242e+09 1.26e+02 1.7e+00 6.7e-02 0.871 0.752 0.00
  13 -1.173406188e+09 +1.32051990e+09 1.13e+02 1.5e+00 6.1e-02 0.870 0.752 0.00
  14 -1.173396907e+09 +1.32050134e+09 1.01e+02 1.3e+00 5.6e-02 0.870 0.751 0.00
  15 -1.173389174e+09 +1.32048587e+09 9.14e+01 1.2e+00 5.1e-02 0.870 0.751 0.00
  16 -1.173382715e+09 +1.32047295e+09 8.30e+01 1.0e+00 4.6e-02 0.870 0.751 0.00
  17 -1.173377275e+09 +1.32046207e+09 7.56e+01 9.5e-01 4.2e-02 0.870 0.751 0.00
  18 -1.173372682e+09 +1.32045288e+09 6.90e+01 8.6e-01 3.8e-02 0.870 0.751 0.00
  19 -1.173368775e+09 +1.32044507e+09 6.31e+01 7.8e-01 3.5e-02 0.870 0.750 0.00
  20 -1.173365436e+09 +1.32043839e+09 5.79e+01 7.2e-01 3.2e-02 0.870 0.750 0.00
  21 -1.173362570e+09 +1.32043266e+09 5.31e+01 6.6e-01 3.0e-02 0.870 0.750 0.00
  22 -1.173360101e+09 +1.32042772e+09 4.88e+01 6.1e-01 2.7e-02 0.870 0.750 0.00
  23 -1.173357968e+09 +1.32042346e+09 4.50e+01 5.6e-01 2.5e-02 0.870 0.750 0.00
  24 -1.173356120e+09 +1.32041976e+09 4.16e+01 5.2e-01 2.3e-02 0.870 0.750 0.00
  25 -1.173354516e+09 +1.32041655e+09 3.85e+01 4.8e-01 2.2e-02 0.870 0.750 0.00
  26 -1.173353124e+09 +1.32041377e+09 3.57e+01 4.5e-01 2.0e-02 0.870 0.750 0.00
  27 -1.173351914e+09 +1.32041135e+09 3.31e+01 4.2e-01 1.8e-02 0.870 0.750 0.00
  28 -1.173350860e+09 +1.32040924e+09 3.07e+01 3.9e-01 1.7e-02 0.870 0.750 0.00
  29 -1.173349940e+09 +1.32040740e+09 2.85e+01 3.6e-01 1.6e-02 0.870 0.750 0.00
  30 -1.173349136e+09 +1.32040579e+09 2.65e+01 3.4e-01 1.5e-02 0.870 0.750 0.00
  31 -1.173348431e+09 +1.32040438e+09 2.47e+01 3.1e-01 1.4e-02 0.870 0.750 0.00
  32 -1.173347815e+09 +1.32040315e+09 2.30e+01 2.9e-01 1.3e-02 0.870 0.750 0.00
  33 -1.173347273e+09 +1.32040207e+09 2.14e+01 2.7e-01 1.2e-02 0.869 0.750 0.00
  34 -1.173346797e+09 +1.32040112e+09 1.99e+01 2.5e-01 1.1e-02 0.869 0.750 0.00
  35 -1.173346380e+09 +1.32040028e+09 1.86e+01 2.4e-01 1.0e-02 0.869 0.750 0.00
  36 -1.173346013e+09 +1.32039955e+09 1.74e+01 2.2e-01 9.8e-03 0.869 0.750 0.00
  37 -1.173345689e+09 +1.32039890e+09 1.62e+01 2.1e-01 9.2e-03 0.869 0.750 0.00
  38 -1.173345404e+09 +1.32039833e+09 1.51e+01 1.9e-01 8.6e-03 0.869 0.750 0.00
  39 -1.173345152e+09 +1.32039783e+09 1.42e+01 1.8e-01 8.1e-03 0.869 0.750 0.00
  40 -1.173344930e+09 +1.32039738e+09 1.33e+01 1.7e-01 7.6e-03 0.869 0.750 0.00
  41 -1.173344733e+09 +1.32039699e+09 1.24e+01 1.6e-01 7.1e-03 0.869 0.750 0.00
  42 -1.173344559e+09 +1.32039664e+09 1.16e+01 1.5e-01 6.7e-03 0.869 0.750 0.00
  43 -1.173344405e+09 +1.32039633e+09 1.09e+01 1.4e-01 6.3e-03 0.869 0.750 0.00
  44 -1.173344270e+09 +1.32039606e+09 1.02e+01 1.3e-01 5.9e-03 0.869 0.750 0.00
  45 -1.173344151e+09 +1.32039582e+09 9.53e+00 1.2e-01 5.6e-03 0.869 0.750 0.00
  46 -1.173344047e+09 +1.32039561e+09 8.91e+00 1.1e-01 5.2e-03 0.869 0.750 0.00
  47 -1.173343955e+09 +1.32039543e+09 8.34e+00 1.1e-01 4.9e-03 0.869 0.750 0.00
  48 -1.173343873e+09 +1.32039527e+09 7.81e+00 9.9e-02 4.6e-03 0.869 0.750 0.00
  49 -1.173343801e+09 +1.32039512e+09 7.32e+00 9.3e-02 4.3e-03 0.869 0.750 0.00
  50 -1.173343738e+09 +1.32039500e+09 6.87e+00 8.7e-02 4.0e-03 0.869 0.750 0.00
  51 -1.173343681e+09 +1.32039488e+09 6.48e+00 8.2e-02 3.8e-03 0.869 0.750 0.00
  52 -1.173343631e+09 +1.32039478e+09 6.12e+00 7.7e-02 3.6e-03 0.869 0.750 0.00
  53 -1.173343587e+09 +1.32039470e+09 5.77e+00 7.2e-02 3.4e-03 0.869 0.750 0.00
  54 -1.173343547e+09 +1.32039462e+09 5.45e+00 6.8e-02 3.2e-03 0.869 0.750 0.00
  55 -1.173343512e+09 +1.32039455e+09 5.15e+00 6.4e-02 3.0e-03 0.869 0.750 0.00
  56 -1.173343481e+09 +1.32039448e+09 4.87e+00 6.0e-02 2.8e-03 0.869 0.750 0.00
  57 -1.173343453e+09 +1.32039443e+09 4.60e+00 5.6e-02 2.6e-03 0.869 0.750 0.00
  58 -1.173343428e+09 +1.32039438e+09 4.35e+00 5.3e-02 2.5e-03 0.869 0.750 0.00
  59 -1.173343406e+09 +1.32039433e+09 4.12e+00 5.0e-02 2.3e-03 0.869 0.750 0.00
  60 -1.173343386e+09 +1.32039429e+09 3.90e+00 4.7e-02 2.2e-03 0.869 0.750 0.00
  61 -1.173343368e+09 +1.32039426e+09 3.69e+00 4.4e-02 2.1e-03 0.869 0.750 0.00
  62 -1.173343352e+09 +1.32039423e+09 3.49e+00 4.2e-02 2.0e-03 0.869 0.750 0.00
  63 -1.173343338e+09 +1.32039420e+09 3.31e+00 3.9e-02 1.9e-03 0.869 0.750 0.00
  64 -1.173343325e+09 +1.32039417e+09 3.13e+00 3.7e-02 1.8e-03 0.869 0.750 0.00
  65 -1.173343314e+09 +1.32039415e+09 2.97e+00 3.5e-02 1.7e-03 0.868 0.750 0.00
  66 -1.173343303e+09 +1.32039413e+09 2.81e+00 3.3e-02 1.6e-03 0.868 0.750 0.00
  67 -1.173343294e+09 +1.32039411e+09 2.67e+00 3.1e-02 1.5e-03 0.868 0.750 0.00
  68 -1.173343286e+09 +1.32039409e+09 2.53e+00 2.9e-02 1.4e-03 0.868 0.750 0.00
  69 -1.173343279e+09 +1.32039408e+09 2.40e+00 2.8e-02 1.3e-03 0.868 0.750 0.00
  70 -1.173343272e+09 +1.32039407e+09 2.28e+00 2.6e-02 1.3e-03 0.868 0.750 0.00
  71 -1.173343266e+09 +1.32039405e+09 2.16e+00 2.5e-02 1.2e-03 0.868 0.750 0.00
  72 -1.173343261e+09 +1.32039404e+09 2.05e+00 2.3e-02 1.1e-03 0.868 0.750 0.00
  73 -1.173343256e+09 +1.32039403e+09 1.94e+00 2.2e-02 1.1e-03 0.868 0.750 0.00
  74 -1.173343251e+09 +1.32039402e+09 1.84e+00 2.1e-02 1.0e-03 0.868 0.750 0.00
  75 -1.173343247e+09 +1.32039402e+09 1.75e+00 2.0e-02 9.6e-04 0.868 0.750 0.00
  76 -1.173343244e+09 +1.32039401e+09 1.66e+00 1.9e-02 9.1e-04 0.868 0.750 0.00
  77 -1.173343241e+09 +1.32039400e+09 1.58e+00 1.8e-02 8.7e-04 0.868 0.750 0.00
  78 -1.173343238e+09 +1.32039400e+09 1.50e+00 1.7e-02 8.2e-04 0.868 0.750 0.00
  79 -1.173343235e+09 +1.32039399e+09 1.42e+00 1.6e-02 7.8e-04 0.868 0.750 0.00
  80 -1.173343233e+09 +1.32039399e+09 1.35e+00 1.5e-02 7.4e-04 0.868 0.750 0.00
  81 -1.173343231e+09 +1.32039398e+09 1.28e+00 1.5e-02 7.0e-04 0.868 0.750 0.00
  82 -1.173343229e+09 +1.32039398e+09 1.22e+00 1.4e-02 6.6e-04 0.868 0.750 0.00
  83 -1.173343227e+09 +1.32039398e+09 1.16e+00 1.3e-02 6.3e-04 0.868 0.750 0.00
  84 -1.173343226e+09 +1.32039397e+09 1.10e+00 1.2e-02 6.0e-04 0.868 0.750 0.00
  85 -1.173343224e+09 +1.32039397e+09 1.04e+00 1.2e-02 5.7e-04 0.868 0.750 0.00
  86 -1.173343223e+09 +1.32039397e+09 9.90e-01 1.1e-02 5.4e-04 0.868 0.750 0.00
  87 -1.173343222e+09 +1.32039397e+09 9.41e-01 1.1e-02 5.1e-04 0.868 0.750 0.00
  88 -1.173343221e+09 +1.32039396e+09 8.94e-01 1.0e-02 4.9e-04 0.868 0.750 0.00
  89 -1.173343220e+09 +1.32039396e+09 8.50e-01 9.6e-03 4.6e-04 0.868 0.750 0.00
  90 -1.173343219e+09 +1.32039396e+09 8.07e-01 9.1e-03 4.4e-04 0.868 0.750 0.00
  91 -1.173343219e+09 +1.32039396e+09 7.67e-01 8.7e-03 4.2e-04 0.868 0.750 0.00
  92 -1.173343218e+09 +1.32039396e+09 7.29e-01 8.3e-03 3.9e-04 0.868 0.750 0.00
  93 -1.173343217e+09 +1.32039396e+09 6.93e-01 7.8e-03 3.7e-04 0.868 0.750 0.00
  94 -1.173343217e+09 +1.32039396e+09 6.59e-01 7.5e-03 3.6e-04 0.868 0.750 0.00
  95 -1.173343216e+09 +1.32039395e+09 6.26e-01 7.1e-03 3.4e-04 0.868 0.750 0.00
  96 -1.173343216e+09 +1.32039395e+09 5.95e-01 6.7e-03 3.2e-04 0.868 0.750 0.00
  97 -1.173343215e+09 +1.32039395e+09 5.66e-01 6.4e-03 3.1e-04 0.868 0.750 0.00
  98 -1.173343215e+09 +1.32039395e+09 5.38e-01 6.1e-03 2.9e-04 0.868 0.750 0.00
  99 -1.173343215e+09 +1.32039395e+09 5.12e-01 5.8e-03 2.8e-04 0.868 0.750 0.00
 100 -1.173343214e+09 +1.32039395e+09 4.87e-01 5.5e-03 2.6e-04 0.868 0.750 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds"))
> 
> proc.time()
    user   system  elapsed 
66667.01 12080.55 41681.83 
