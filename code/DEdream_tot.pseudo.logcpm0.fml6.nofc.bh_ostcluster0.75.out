
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   name="noarg"
+   data.source="tot"
+   data.type="pseudo"
+   filter.arg=TRUE
+   filter.type="logcpm"
+   filter.param=0
+   fml="formula6"
+   lfc=FALSE
+   fdr="BH"
+   assign="all"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("file tag: ",name))
[1] "file tag: tot.pseudo.logcpm0.fml6.nofc.bh"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> print(paste0("data type: ",data.type))
[1] "data type: pseudo"
> print(paste0("filter genes: ",filter.arg))
[1] "filter genes: TRUE"
> print(paste0("filter type: ",filter.type))
[1] "filter type: logcpm"
> print(paste0("gene filter.param: ",filter.param))
[1] "gene filter.param: 0"
> print(paste0("adjuste logFC in test: ",lfc))
[1] "adjuste logFC in test: FALSE"
> print(paste0("fdr method: ",fdr))
[1] "fdr method: BH"
> print(paste0("cell assignment: ",assign))
[1] "cell assignment: ostcluster0.75"
> 
> #Load libraries
> library(Seurat)
> library(dplyr)

Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

> library(stringi)
> library(stringr)
> library(ggplot2)
> library(grid)
> library(gbm)
Loaded gbm 2.1.5
> library(colorspace)
> library(RColorBrewer)
> library(edgeR)
Loading required package: limma
> library(scran)
Loading required package: SingleCellExperiment
Loading required package: SummarizedExperiment
Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: 'BiocGenerics'

The following objects are masked from 'package:parallel':

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following object is masked from 'package:limma':

    plotMA

The following objects are masked from 'package:dplyr':

    combine, intersect, setdiff, union

The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs

The following objects are masked from 'package:base':

    Filter, Find, Map, Position, Reduce, anyDuplicated, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which, which.max, which.min

Loading required package: S4Vectors

Attaching package: 'S4Vectors'

The following objects are masked from 'package:dplyr':

    first, rename

The following object is masked from 'package:base':

    expand.grid

Loading required package: IRanges

Attaching package: 'IRanges'

The following objects are masked from 'package:dplyr':

    collapse, desc, slice

Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: DelayedArray
Loading required package: matrixStats

Attaching package: 'matrixStats'

The following objects are masked from 'package:Biobase':

    anyMissing, rowMedians

The following object is masked from 'package:dplyr':

    count

Loading required package: BiocParallel

Attaching package: 'DelayedArray'

The following objects are masked from 'package:matrixStats':

    colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges

The following objects are masked from 'package:base':

    aperm, apply, rowsum


Attaching package: 'SummarizedExperiment'

The following object is masked from 'package:Seurat':

    Assays


Attaching package: 'SingleCellExperiment'

The following object is masked from 'package:edgeR':

    cpm

> library(SingleCellExperiment)
> library(limma)
> library(variancePartition)
Loading required package: foreach
Loading required package: scales

Attaching package: 'variancePartition'

The following object is masked from 'package:limma':

    classifyTestsF

> library(BiocParallel)
> 
> #detectCores()
> register(SnowParam(4))
> 
> #Load data (conservative cell filter + integrated across individuals + non-zero genes + regress out UMI/mito)
> if (data.source=="tot") {
+   data.dir <- "./../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-tot.assign.rds"
+   data <- readRDS(data.dir)
+ }
> if (data.source=="t0") {
+   data.dir <- "./../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-t0.assign.rds"
+   data <- readRDS(data.dir)
+ }
> if (data.source=="t1") {
+   data.dir <- "./../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-t1.assign.rds"
+   data <- readRDS(data.dir)
+ }
> if (data.source=="t2") {
+   data.dir <- "./../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-t2.assign.rds"
+   data <- readRDS(data.dir)
+ }
> print(data.dir)
[1] "./../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-tot.assign.rds"
> data
An object of class Seurat 
37859 features across 101000 samples within 2 assays 
Active assay: integrated (18482 features)
 1 other assay present: RNA
 2 dimensional reductions calculated: pca, umap
> 
> #Define individual-replicate sets
> data@meta.data$Individual.Replicate <- paste0(data@meta.data$Individual,".",data@meta.data$Replicate)
> 
> #Isolate mitochondrial and ribosomal genes
> genes <- rownames(data@assays$RNA@counts)
> genes.mito <- c("MT-ATP6","MT-ATP8","MT-CO1","MT-CO2","MT-CO3","MT-CYB","MT-ND1","MT-ND2","MT-ND3","MT-ND4","MT-ND4L","MT-ND5")
> genes.ribo <- grep('^RP',genes,value=T)
> genes.no.mito.ribo <- genes[which(!(genes %in% c(genes.mito,genes.ribo)))]
> rm(genes,genes.mito,genes.ribo)
> 
> #Define Limma Voom (Dream) Function
> runDREAM <- function(dataSub, data.dir, cell.assign, cell.subset, genes.no.mito.ribo, data.type, filter.arg, filter.type, filter.param, fml) {
+ 
+   #make count matrix and metadata for edgeR object
+   if (data.type=="pseudo") {
+     counts <- c()
+     metadata <- c()
+     labels <- c()
+     for (i in unique(dataSub@meta.data$Individual.Replicate)) {
+       x.lab <- i
+       w <- which(dataSub@meta.data$Individual.Replicate==i)
+       if (length(w)>0) {
+         x.spp <- dataSub@meta.data$Species[w][1]
+         x.col <- dataSub@meta.data$Collection[w][1]
+         x.ind <- dataSub@meta.data$Individual[w][1]
+         x.rep <- dataSub@meta.data$Replicate[w][1]
+         if (length(w)==1) {
+           x.cnt <- dataSub@assays$RNA@counts[,w]
+         } else {
+           x.cnt <- Matrix::rowSums(dataSub@assays$RNA@counts[,w])
+         }
+         counts <- cbind(counts, x.cnt)
+         metadata <- rbind(metadata, c(x.lab, x.spp, x.col, x.ind, x.rep))
+         labels <- c(labels, x.lab)
+       }
+     }
+     colnames(counts) <- labels
+     rownames(metadata) <- labels
+     colnames(metadata) <- c("Individual.Replicate","Species","Collection","Individual","Replicate")
+     metadata <- as.data.frame(metadata)
+     rm(labels)
+   }
+   if (data.type=="sc") {
+     counts <- as.matrix(GetAssayData(dataSub, assay="RNA", slot="counts"))
+     metadata <- dataSub@meta.data[,c("Species","Individual.Replicate","Individual","Replicate","Collection","percent.mt","Phase","Sample")]
+     metadata <- metadata[colnames(counts),]
+   }
+ 
+   #remove mitochodrial and ribosomal genes
+   counts <- counts[which(rownames(counts) %in% genes.no.mito.ribo),]
+ 
+   #make edgeR object
+   dge <- DGEList(counts)
+   meta_dge <- dge$samples[,c("lib.size","norm.factors")]
+   meta_dge <- cbind(meta_dge, metadata)
+   dge$samples <- meta_dge
+   rm(dataSub,counts,metadata,meta_dge)
+ 
+   #filter genes
+   if (filter.arg==TRUE){
+     if (filter.type=="logcpm"){
+       keep <- rowMeans(edgeR::cpm(dge,log=TRUE,prior.count=0.25))>filter.param
+       dge$counts <- dge$counts[keep,]
+     }
+     if (filter.type=="min.count"){
+       keep <- filterByExpr(dge, group=dge$samples$Species, min.count=filter.param, min.total.count=15)
+       table(keep)
+       dge <- dge[keep, , keep.lib.sizes=FALSE]
+       rm(keep)
+     }
+     if (filter.type=="pch"){
+       dge$counts <- dge$counts[rowSums(dge$counts!=0)>=(filter.param*dim(dge$counts)[2]),]
+     }
+   }
+ 
+   #normalize data
+   dge <- calcNormFactors(dge, method="TMM")
+   summary(dge$samples$norm.factors)
+ 
+   #prep design matrix variables
+   dge$samples$Individual.Replicate <- as.factor(dge$samples$Individual.Replicate)
+   dge$samples$Individual <- as.factor(dge$samples$Individual)
+   dge$samples$Replicate <- as.factor(as.character(dge$samples$Replicate))
+   dge$samples$Species <- as.factor(dge$samples$Species)
+   dge$samples$Collection <- as.factor(as.numeric(dge$samples$Collection))
+   if (data.type=="sc") {
+     dge$samples$Phase <- as.factor(dge$samples$Phase)
+     dge$samples$Sample <- as.factor(dge$samples$Sample)
+   }
+ 
+   #design matrix
+   if (fml=="formula1") {
+     model <- "~Species+(1|Individual)+(1|Replicate)"
+     formula <- ~Species+(1|Individual)+(1|Replicate)
+   }
+   if (fml=="formula2") {
+     model <- "~Species+Collection+percent.mt+Phase+(1|Individual)"
+     formula <- ~Species+Collection+percent.mt+Phase+(1|Individual)
+   }
+   if (fml=="formula3") {
+     model <- "~Species+percent.mt+Phase+(1|Sample)"
+     formula <- ~Species+percent.mt+Phase+(1|Sample)
+   }
+   if (fml=="formula4" & data.type=="pseudo") {
+     model <- "~Species+(1|Individual)+(1|Replicate)"
+     formula <- ~Species+(1|Individual)+(1|Replicate)
+   }
+   if (fml=="formula4" & data.type=="sc") {
+     model <- "~Species+percent.mt+Phase+(1|Individual)+(1|Replicate)"
+     formula <- ~Species+percent.mt+Phase+(1|Individual)+(1|Replicate)
+   }
+   if (fml=="formula5" & data.type=="pseudo") {
+     model <- "~Species+(1|Individual)"
+     formula <- ~Species+(1|Individual)
+   }
+   if (fml=="formula5" & data.type=="sc") {
+     model <- "~Species+percent.mt+Phase+(1|Individual)"
+     formula <- ~Species+percent.mt+Phase+(1|Individual)
+   }
+   if (fml=="formula6" & data.type=="pseudo") {
+     model <- "~Species+(1|Individual)"
+     formula <- ~Species+(1|Individual)
+   }
+   if (fml=="formula6" & data.type=="pseudo" & cell.assign=="ostcluster0.50" & cell.subset=="Osteogenic.c2") {
+     model <- "~Species"
+     formula <- ~Species
+   }
+   if (fml=="formula6" & data.type=="pseudo" & cell.assign=="ostcluster0.75" & cell.subset=="Osteogenic.c6") {
+     model <- "~Species"
+     formula <- ~Species
+   }
+   if (fml=="formula6" & data.type=="pseudo" & (cell.assign=="ostadhocX" | cell.assign=="ostadhocX.T2") & cell.subset=="mineralizing osteoblast") {
+     model <- "~Species"
+     formula <- ~Species
+   }
+   if (fml=="formula6" & data.type=="sc") {
+     model <- "~Species+percent.mt+Phase+(1|Individual.Replicate)"
+     formula <- ~Species+percent.mt+Phase+(1|Individual.Replicate)
+   }
+ 
+   #estimate weights using linear mixed model of dream (voom)
+   vobjDream = voomWithDreamWeights(counts=dge, formula=formula, data=dge$samples)
+ 
+   #define contrasts
+   #L = getContrast(vobjDream, formula, dge$samples, coefficient="SpeciesHuman")
+   #plotContrasts(L)
+ 
+   #fit dream model on each gene
+   fitmm = dream(vobjDream, formula, dge$samples)
+ 
+   #assess differential expression output for particular contrast
+   tt <- topTable(fitmm, n=Inf, coef='SpeciesHuman', adjust.method="BH", p.value=1)
+   print("All DE Genes")
+   print(dim(tt))
+   print(table(tt$adj.P.Val<0.01))
+   print(summary(decideTests(fitmm, adjust.method=fdr, p.value=0.01)))
+ 
+   #rename final column of toptable to enable rbind()
+   #column name is "B" for mineralizing osteoblasts in ostadhocX and ostadhocX.T2
+   colnames(tt)[6] <- "z.std"
+ 
+   #add details to output
+   tt$data <- rep(data.dir, dim(tt)[1])
+   tt$data.type <- rep(data.type, dim(tt)[1])
+   tt$cell.assign <- rep(cell.assign, dim(tt)[1])
+   tt$cell.subset <- rep(cell.subset, dim(tt)[1])
+   tt$gene.filter <- rep(filter.arg, dim(tt)[1])
+   tt$gene.filter.args <- rep(paste0("filter.param=",filter.param), dim(tt)[1])
+   tt$model <- rep(model, dim(tt)[1])
+   tt$comparison <- rep(tt$comparison, dim(tt)[1])
+   tt$test <- rep(tt$test, dim(tt)[1])
+   tt$adjust.method <- rep(tt$adjust.method, dim(tt)[1])
+   tt$gene <- rownames(tt)
+ 
+   return(tt)
+ 
+ }
> 
> #Find differentially expressed genes for different cell assignment subtypes
> if (assign=="stage") {
+   subset.list <- list(stage=list("stage-Time 0",
+                                  "stage-Time 1",
+                                  "stage-Time 2"))
+ }
> if (assign=="cluster"  & data.source=="tot") {
+   subset.list <- list(clust=list("cluster-iPSC.c1",
+                                  "cluster-iPSC.c2",
+                                  "cluster-iPSC.c3",
+                                  "cluster-MSC.c1",
+                                  "cluster-Osteogenic.c1",
+                                  "cluster-Osteogenic.c2"),
+                       combI=c("cluster-iPSC.c1_iPSC.c2_iPSC.c3"),
+                       combO=c("cluster-Osteogenic.c1_Osteogenic.c2"))
+ }
> if (assign=="adhoc") {
+   subset.list <- list(adhoc=list("adhoc-iPSC",
+                                  "adhoc-MSC",
+                                  "adhoc-Osteogenic"))
+ }
> if (assign=="ostcluster0.50"  & data.source=="tot") {
+   subset.list <- list(clust=list("ostcluster0.50-Osteogenic.c1",
+                                  "ostcluster0.50-Osteogenic.c2",
+                                  "ostcluster0.50-Osteogenic.c3",
+                                  "ostcluster0.50-Osteogenic.c4"))
+ }
> if (assign=="ostcluster0.75"  & data.source=="tot") {
+   subset.list <- list(clust=list("ostcluster0.75-Osteogenic.c1",
+                                  "ostcluster0.75-Osteogenic.c2",
+                                  "ostcluster0.75-Osteogenic.c3",
+                                  "ostcluster0.75-Osteogenic.c4",
+                                  "ostcluster0.75-Osteogenic.c5",
+                                  "ostcluster0.75-Osteogenic.c6",
+                                  "ostcluster0.75-Osteogenic.c7",
+                                  "ostcluster0.75-Osteogenic.c8"))
+ }
> if (assign=="ostadhoc") {
+   subset.list <- list(ostadhoc=list("ostadhoc-preosteoblast",
+                                     "ostadhoc-osteoblast",
+                                     "ostadhoc-embedding osteoblast",
+                                     "ostadhoc-mineralizing osteoblast",
+                                     "ostadhoc-maturing osteocyte"))
+ }
> if (assign=="ostadhocX") {
+   subset.list <- list(ostadhoc=list("ostadhocX-preosteoblast",
+                                     "ostadhocX-osteoblast",
+                                     "ostadhocX-embedding osteoblast",
+                                     "ostadhocX-mineralizing osteoblast",
+                                     "ostadhocX-maturing osteocyte"))
+ }
> if (assign=="ostadhoc.T2") {
+   subset.list <- list(ostadhoc=list("ostadhoc.T2-preosteoblast",
+                                     "ostadhoc.T2-osteoblast",
+                                     "ostadhoc.T2-embedding osteoblast",
+                                     "ostadhoc.T2-mineralizing osteoblast",
+                                     "ostadhoc.T2-maturing osteocyte"))
+ }
> if (assign=="ostadhocX.T2") {
+   subset.list <- list(ostadhoc=list("ostadhocX.T2-preosteoblast",
+                                     "ostadhocX.T2-osteoblast",
+                                     "ostadhocX.T2-embedding osteoblast",
+                                     "ostadhocX.T2-mineralizing osteoblast",
+                                     "ostadhocX.T2-maturing osteocyte"))
+ }
> 
> DEgene.total <- data.frame()
> 
> for (i in subset.list) {
+ 
+   for (j in i) {
+ 
+     print(j)
+ 
+     #define cell assignment and subtype of interest
+     cell.assign <- str_split(j,"-")[[1]][1]
+     cell.subset <- str_split(j,"-")[[1]][2]
+ 
+     #define data subset
+     if (str_count(cell.subset,"_")>=1){
+ 
+       if (length(str_split(cell.subset,"_")[[1]])==2) {
+         dataSub <- subset(data,
+                           subset=Cluster0.05==str_split(cell.subset,"_")[[1]][1]|
+                             Cluster0.05==str_split(cell.subset,"_")[[1]][2])
+       }
+       else {
+         dataSub <- subset(data,
+                           subset=Cluster0.05==str_split(cell.subset,"_")[[1]][1]|
+                             Cluster0.05==str_split(cell.subset,"_")[[1]][2]|
+                             Cluster0.05==str_split(cell.subset,"_")[[1]][3])
+       }
+     }
+ 
+     else {
+       if(cell.assign=="stage")          { dataSub <- subset(data,subset=Stage==cell.subset) }
+       if(cell.assign=="cluster")        { dataSub <- subset(data,subset=Cluster0.05==cell.subset) }
+       if(cell.assign=="adhoc")          { dataSub <- subset(data,subset=AdHoc.Assign.thresh0==cell.subset) }
+       if(cell.assign=="ostcluster0.50") { dataSub <- subset(data,subset=Cluster0.50==cell.subset) }
+       if(cell.assign=="ostcluster0.75") { dataSub <- subset(data,subset=Cluster0.75==cell.subset) }
+       if(cell.assign=="ostadhoc")       { dataSub <- subset(data,subset=OstAdHoc.Assign.4gene.thresh0==cell.subset) }
+       if(cell.assign=="ostadhocX")      { dataSub <- subset(data,subset=OstAdHoc.Assign.x.4gene.thresh0==cell.subset) }
+       if(cell.assign=="ostadhoc.T2")    { dataSub <- subset(data,subset=OstAdHoc.Assign.4gene.thresh0==cell.subset & Stage=="Time 2") }
+       if(cell.assign=="ostadhocX.T2")   { dataSub <- subset(data,subset=OstAdHoc.Assign.x.4gene.thresh0==cell.subset & Stage=="Time 2") }
+     }
+ 
+     #de analysis
+     DEgene <- runDREAM(dataSub=dataSub,
+                        data.dir=data.dir,
+                        cell.assign=cell.assign,
+                        cell.subset=cell.subset,
+                        genes.no.mito.ribo=genes.no.mito.ribo,
+                        data.type=data.type,
+                        filter.arg=filter.arg,
+                        filter.type=filter.type,
+                        filter.param=filter.param,
+                        fml=fml)
+ 
+     DEgene.total <- rbind(DEgene.total,DEgene)
+ 
+     print(dim(DEgene.total))
+ 
+     saveRDS(DEgene.total, file=paste0("./../data/de-data/DEdream.",name,".",assign,".rds"))
+ 
+   }
+ 
+ }
[1] "ostcluster0.75-Osteogenic.c1"
Memory usage to store result: > 17.9 Mb 
Dividing work into 100 chunks...

Total: 69 s
Dividing work into 100 chunks...

Total: 195 s
[1] "All DE Genes"
[1] 11297     6

FALSE  TRUE 
10933   364 
       (Intercept) SpeciesHuman
Down             5          157
NotSig        1115        10933
Up           10177          207
[1] 11297    14
[1] "ostcluster0.75-Osteogenic.c2"
Memory usage to store result: > 18.5 Mb 
Dividing work into 100 chunks...

Total: 70 s
Dividing work into 100 chunks...

Total: 202 s
[1] "All DE Genes"
[1] 11635     6

FALSE  TRUE 
11202   433 
       (Intercept) SpeciesHuman
Down             6          195
NotSig        1163        11202
Up           10466          238
[1] 22932    14
[1] "ostcluster0.75-Osteogenic.c3"
Memory usage to store result: > 17.5 Mb 
Dividing work into 100 chunks...

Total: 67 s
Dividing work into 100 chunks...

Total: 191 s
[1] "All DE Genes"
[1] 11043     6

FALSE  TRUE 
10616   427 
       (Intercept) SpeciesHuman
Down             6          109
NotSig         860        10616
Up           10177          318
[1] 33975    14
[1] "ostcluster0.75-Osteogenic.c4"
Memory usage to store result: > 16.9 Mb 
Dividing work into 100 chunks...

Total: 65 s
Dividing work into 100 chunks...

Total: 184 s
[1] "All DE Genes"
[1] 10665     6

FALSE  TRUE 
10469   196 
       (Intercept) SpeciesHuman
Down             0           64
NotSig        1199        10469
Up            9466          132
[1] 44640    14
[1] "ostcluster0.75-Osteogenic.c5"
Memory usage to store result: > 16.9 Mb 
Dividing work into 100 chunks...

Total: 66 s
Dividing work into 100 chunks...

Total: 186 s
[1] "All DE Genes"
[1] 10670     6

FALSE  TRUE 
10399   271 
       (Intercept) SpeciesHuman
Down             0          119
NotSig         645        10399
Up           10025          152
[1] 55310    14
[1] "ostcluster0.75-Osteogenic.c6"
Fixed effect model, using limma directly...
Fixed effect model, using limma directly...
Applying eBayes()...
[1] "All DE Genes"
[1] 8203    6

FALSE  TRUE 
 8202     1 
       (Intercept) SpeciesHuman
Down             0            0
NotSig          39         8202
Up            8164            1
[1] 63513    14
[1] "ostcluster0.75-Osteogenic.c7"
Memory usage to store result: > 30.5 Mb 
Dividing work into 100 chunks...

Total: 104 s
Dividing work into 100 chunks...

Total: 323 s
[1] "All DE Genes"
[1] 19221     6

FALSE  TRUE 
19220     1 
       (Intercept) SpeciesHuman
Down             0            0
NotSig           3        19220
Up           19218            1
[1] 82734    14
[1] "ostcluster0.75-Osteogenic.c8"
Memory usage to store result: > 30.5 Mb 
Dividing work into 100 chunks...

Total: 104 s
Dividing work into 100 chunks...

Total: 321 s
[1] "All DE Genes"
[1] 19221     6

FALSE  TRUE 
19220     1 
       (Intercept) SpeciesHuman
Down             0            0
NotSig           1        19220
Up           19220            1
[1] 101955     14
Warning messages:
1: In regularize.values(x, y, ties, missing(ties)) :
  collapsing to unique 'x' values
2: In regularize.values(x, y, ties, missing(ties)) :
  collapsing to unique 'x' values
3: In regularize.values(x, y, ties, missing(ties)) :
  collapsing to unique 'x' values
4: In regularize.values(x, y, ties, missing(ties)) :
  collapsing to unique 'x' values
> 
> 
> 
> proc.time()
    user   system  elapsed 
 544.901  109.397 2672.129 
