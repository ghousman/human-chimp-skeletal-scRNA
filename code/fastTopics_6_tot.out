
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 6"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-6 Poisson NMF to 101000 x 18482 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.162101419e+09 +1.29791036e+09 2.45e+04 1.1e+02 1.4e+00 0.765 0.720 0.00
   2 -1.150889991e+09 +1.27548750e+09 3.66e+04 8.8e+01 2.5e+00 0.776 0.840 0.00
   3 -1.146781222e+09 +1.26726997e+09 1.54e+04 5.9e+01 1.5e+00 0.780 0.771 0.00
   4 -1.144563516e+09 +1.26283455e+09 3.38e+03 4.2e+01 2.2e+00 0.784 0.767 0.00
   5 -1.143436895e+09 +1.26058131e+09 1.09e+03 2.6e+01 7.9e-01 0.789 0.762 0.00
   6 -1.142765478e+09 +1.25923848e+09 1.08e+03 1.6e+01 6.1e-01 0.792 0.754 0.00
   7 -1.142279304e+09 +1.25826613e+09 1.77e+03 1.1e+01 5.9e-01 0.795 0.746 0.00
   8 -1.141903851e+09 +1.25751522e+09 1.50e+03 8.0e+00 4.9e-01 0.798 0.739 0.00
   9 -1.141606655e+09 +1.25692083e+09 1.19e+03 5.9e+00 3.8e-01 0.800 0.735 0.00
  10 -1.141372038e+09 +1.25645160e+09 1.05e+03 4.4e+00 2.9e-01 0.801 0.731 0.00
  11 -1.141189902e+09 +1.25608732e+09 6.45e+02 3.7e+00 2.3e-01 0.802 0.729 0.00
  12 -1.141051428e+09 +1.25581038e+09 5.61e+02 3.1e+00 2.0e-01 0.803 0.728 0.00
  13 -1.140946694e+09 +1.25560091e+09 4.75e+02 2.8e+00 1.7e-01 0.803 0.727 0.00
  14 -1.140867184e+09 +1.25544189e+09 3.87e+02 2.4e+00 1.5e-01 0.803 0.727 0.00
  15 -1.140805495e+09 +1.25531851e+09 3.58e+02 2.1e+00 1.3e-01 0.803 0.727 0.00
  16 -1.140756633e+09 +1.25522079e+09 3.97e+02 1.9e+00 1.2e-01 0.804 0.726 0.00
  17 -1.140716981e+09 +1.25514148e+09 4.22e+02 1.8e+00 1.0e-01 0.803 0.727 0.00
  18 -1.140683983e+09 +1.25507549e+09 4.37e+02 1.7e+00 9.2e-02 0.804 0.727 0.00
  19 -1.140655922e+09 +1.25501937e+09 4.43e+02 1.6e+00 8.2e-02 0.804 0.727 0.00
  20 -1.140631662e+09 +1.25497085e+09 4.37e+02 1.4e+00 7.3e-02 0.803 0.727 0.00
  21 -1.140610528e+09 +1.25492858e+09 3.74e+02 1.4e+00 7.4e-02 0.804 0.727 0.00
  22 -1.140591804e+09 +1.25489113e+09 3.00e+02 1.3e+00 7.7e-02 0.804 0.728 0.00
  23 -1.140574926e+09 +1.25485737e+09 2.77e+02 1.2e+00 7.9e-02 0.804 0.728 0.00
  24 -1.140559473e+09 +1.25482647e+09 2.74e+02 1.1e+00 8.1e-02 0.804 0.728 0.00
  25 -1.140545137e+09 +1.25479779e+09 2.71e+02 1.0e+00 8.3e-02 0.804 0.728 0.00
  26 -1.140531713e+09 +1.25477095e+09 2.66e+02 9.6e-01 8.4e-02 0.804 0.728 0.00
  27 -1.140519054e+09 +1.25474563e+09 2.62e+02 9.0e-01 8.5e-02 0.805 0.729 0.00
  28 -1.140507059e+09 +1.25472164e+09 2.57e+02 8.4e-01 8.6e-02 0.805 0.729 0.00
  29 -1.140495652e+09 +1.25469882e+09 2.52e+02 7.8e-01 8.6e-02 0.805 0.729 0.00
  30 -1.140484819e+09 +1.25467716e+09 2.45e+02 7.4e-01 8.6e-02 0.805 0.729 0.00
  31 -1.140474521e+09 +1.25465656e+09 2.37e+02 7.0e-01 8.6e-02 0.805 0.729 0.00
  32 -1.140464692e+09 +1.25463691e+09 2.29e+02 6.6e-01 8.5e-02 0.805 0.729 0.00
  33 -1.140455294e+09 +1.25461811e+09 2.21e+02 6.3e-01 8.4e-02 0.806 0.729 0.00
  34 -1.140446295e+09 +1.25460011e+09 2.14e+02 6.1e-01 8.2e-02 0.806 0.729 0.00
  35 -1.140437647e+09 +1.25458281e+09 2.06e+02 6.1e-01 8.1e-02 0.806 0.729 0.00
  36 -1.140429287e+09 +1.25456610e+09 1.99e+02 6.0e-01 7.9e-02 0.806 0.729 0.00
  37 -1.140421168e+09 +1.25454986e+09 1.96e+02 6.0e-01 7.8e-02 0.807 0.729 0.00
  38 -1.140413251e+09 +1.25453402e+09 2.03e+02 6.0e-01 7.7e-02 0.807 0.729 0.00
  39 -1.140405492e+09 +1.25451851e+09 2.04e+02 5.9e-01 7.7e-02 0.807 0.729 0.00
  40 -1.140397847e+09 +1.25450321e+09 1.99e+02 5.9e-01 7.7e-02 0.807 0.729 0.00
  41 -1.140390276e+09 +1.25448807e+09 1.96e+02 5.9e-01 7.7e-02 0.807 0.730 0.00
  42 -1.140382723e+09 +1.25447297e+09 2.37e+02 5.9e-01 7.8e-02 0.807 0.730 0.00
  43 -1.140375180e+09 +1.25445788e+09 2.68e+02 5.9e-01 7.8e-02 0.808 0.730 0.00
  44 -1.140367626e+09 +1.25444277e+09 2.84e+02 5.9e-01 7.9e-02 0.808 0.730 0.00
  45 -1.140360044e+09 +1.25442761e+09 2.79e+02 5.9e-01 7.9e-02 0.808 0.730 0.00
  46 -1.140352426e+09 +1.25441237e+09 2.51e+02 5.9e-01 8.0e-02 0.808 0.730 0.00
  47 -1.140344797e+09 +1.25439712e+09 2.26e+02 6.0e-01 8.2e-02 0.808 0.730 0.00
  48 -1.140337210e+09 +1.25438194e+09 2.25e+02 5.9e-01 8.6e-02 0.808 0.730 0.00
  49 -1.140329729e+09 +1.25436698e+09 2.30e+02 5.9e-01 8.7e-02 0.809 0.731 0.00
  50 -1.140322434e+09 +1.25435239e+09 2.31e+02 5.8e-01 8.8e-02 0.809 0.731 0.00
  51 -1.140315406e+09 +1.25433833e+09 2.30e+02 5.6e-01 8.8e-02 0.809 0.731 0.00
  52 -1.140308709e+09 +1.25432494e+09 2.27e+02 5.5e-01 8.7e-02 0.809 0.731 0.00
  53 -1.140302389e+09 +1.25431230e+09 2.21e+02 5.2e-01 8.5e-02 0.809 0.731 0.00
  54 -1.140296470e+09 +1.25430046e+09 2.13e+02 5.0e-01 8.3e-02 0.809 0.731 0.00
  55 -1.140290971e+09 +1.25428946e+09 2.04e+02 4.7e-01 8.0e-02 0.810 0.731 0.00
  56 -1.140285900e+09 +1.25427932e+09 2.16e+02 4.4e-01 7.6e-02 0.810 0.731 0.00
  57 -1.140281247e+09 +1.25427002e+09 2.31e+02 4.3e-01 7.3e-02 0.810 0.731 0.00
  58 -1.140276999e+09 +1.25426152e+09 2.38e+02 4.2e-01 6.8e-02 0.810 0.731 0.00
  59 -1.140273135e+09 +1.25425379e+09 2.33e+02 4.1e-01 6.4e-02 0.810 0.731 0.00
  60 -1.140269632e+09 +1.25424678e+09 2.15e+02 4.0e-01 6.0e-02 0.810 0.731 0.00
  61 -1.140266463e+09 +1.25424045e+09 1.89e+02 3.8e-01 5.6e-02 0.810 0.731 0.00
  62 -1.140263603e+09 +1.25423473e+09 1.56e+02 3.7e-01 5.2e-02 0.810 0.731 0.00
  63 -1.140261029e+09 +1.25422958e+09 1.27e+02 3.5e-01 4.8e-02 0.810 0.731 0.00
  64 -1.140258714e+09 +1.25422495e+09 1.18e+02 3.3e-01 4.4e-02 0.811 0.731 0.00
  65 -1.140256632e+09 +1.25422079e+09 1.10e+02 3.3e-01 4.0e-02 0.810 0.731 0.00
  66 -1.140254760e+09 +1.25421704e+09 1.03e+02 3.2e-01 3.7e-02 0.811 0.731 0.00
  67 -1.140253079e+09 +1.25421368e+09 9.61e+01 3.1e-01 3.4e-02 0.811 0.731 0.00
  68 -1.140251569e+09 +1.25421066e+09 8.97e+01 2.9e-01 3.1e-02 0.811 0.731 0.00
  69 -1.140250211e+09 +1.25420794e+09 8.36e+01 2.8e-01 2.9e-02 0.811 0.731 0.00
  70 -1.140248989e+09 +1.25420550e+09 7.79e+01 2.7e-01 2.6e-02 0.811 0.731 0.00
  71 -1.140247888e+09 +1.25420330e+09 7.25e+01 2.6e-01 2.4e-02 0.811 0.731 0.00
  72 -1.140246894e+09 +1.25420131e+09 6.77e+01 2.5e-01 2.2e-02 0.811 0.731 0.00
  73 -1.140245993e+09 +1.25419951e+09 6.36e+01 2.5e-01 2.0e-02 0.811 0.731 0.00
  74 -1.140245175e+09 +1.25419787e+09 5.98e+01 2.4e-01 1.9e-02 0.811 0.731 0.00
  75 -1.140244433e+09 +1.25419639e+09 5.75e+01 2.3e-01 1.7e-02 0.811 0.731 0.00
  76 -1.140243758e+09 +1.25419504e+09 5.53e+01 2.2e-01 1.6e-02 0.811 0.731 0.00
  77 -1.140243144e+09 +1.25419381e+09 5.33e+01 2.1e-01 1.5e-02 0.811 0.731 0.00
  78 -1.140242584e+09 +1.25419269e+09 5.12e+01 2.1e-01 1.3e-02 0.811 0.731 0.00
  79 -1.140242074e+09 +1.25419167e+09 4.93e+01 2.0e-01 1.2e-02 0.811 0.731 0.00
  80 -1.140241608e+09 +1.25419074e+09 4.74e+01 1.9e-01 1.2e-02 0.811 0.731 0.00
  81 -1.140241181e+09 +1.25418988e+09 4.55e+01 1.8e-01 1.1e-02 0.811 0.731 0.00
  82 -1.140240791e+09 +1.25418910e+09 4.37e+01 1.8e-01 1.1e-02 0.811 0.731 0.00
  83 -1.140240435e+09 +1.25418839e+09 4.20e+01 1.7e-01 1.1e-02 0.811 0.731 0.00
  84 -1.140240108e+09 +1.25418774e+09 4.03e+01 1.6e-01 1.1e-02 0.811 0.731 0.00
  85 -1.140239808e+09 +1.25418714e+09 3.87e+01 1.6e-01 1.0e-02 0.811 0.731 0.00
  86 -1.140239534e+09 +1.25418659e+09 3.72e+01 1.5e-01 9.9e-03 0.811 0.731 0.00
  87 -1.140239282e+09 +1.25418608e+09 3.75e+01 1.5e-01 9.6e-03 0.811 0.731 0.00
  88 -1.140239050e+09 +1.25418562e+09 3.87e+01 1.4e-01 9.3e-03 0.811 0.731 0.00
  89 -1.140238838e+09 +1.25418520e+09 3.97e+01 1.4e-01 9.0e-03 0.811 0.731 0.00
  90 -1.140238643e+09 +1.25418481e+09 4.06e+01 1.3e-01 8.7e-03 0.811 0.731 0.00
  91 -1.140238463e+09 +1.25418445e+09 4.12e+01 1.3e-01 8.4e-03 0.811 0.731 0.00
  92 -1.140238298e+09 +1.25418412e+09 4.18e+01 1.2e-01 8.1e-03 0.811 0.731 0.00
  93 -1.140238147e+09 +1.25418382e+09 4.22e+01 1.2e-01 7.8e-03 0.811 0.731 0.00
  94 -1.140238007e+09 +1.25418354e+09 4.24e+01 1.1e-01 7.5e-03 0.811 0.731 0.00
  95 -1.140237879e+09 +1.25418328e+09 4.25e+01 1.1e-01 7.3e-03 0.811 0.731 0.00
  96 -1.140237761e+09 +1.25418304e+09 4.25e+01 1.0e-01 7.0e-03 0.811 0.731 0.00
  97 -1.140237653e+09 +1.25418283e+09 4.24e+01 9.9e-02 6.7e-03 0.811 0.731 0.00
  98 -1.140237553e+09 +1.25418263e+09 4.22e+01 9.5e-02 6.5e-03 0.811 0.731 0.00
  99 -1.140237461e+09 +1.25418244e+09 4.19e+01 9.1e-02 6.2e-03 0.811 0.731 0.00
 100 -1.140237376e+09 +1.25418227e+09 4.15e+01 8.8e-02 6.0e-03 0.811 0.731 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
88242.571  8476.515 45403.055 
