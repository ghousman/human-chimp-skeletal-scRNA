
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 5"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-5 Poisson NMF to 101534 x 18454 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.124784964e+09 +1.26256804e+09 2.15e+04 2.6e+02 1.1e+00 0.807 0.738 0.00
   2 -1.114757918e+09 +1.24251394e+09 9.87e+03 8.0e+01 2.3e+00 0.832 0.815 0.00
   3 -1.111030474e+09 +1.23505906e+09 4.15e+03 4.4e+01 1.5e+00 0.834 0.793 0.00
   4 -1.109559923e+09 +1.23211795e+09 4.77e+03 2.5e+01 1.2e+00 0.841 0.776 0.00
   5 -1.108757725e+09 +1.23051356e+09 2.25e+03 1.5e+01 5.5e-01 0.843 0.770 0.00
   6 -1.108302356e+09 +1.22960282e+09 1.55e+03 1.2e+01 5.1e-01 0.845 0.755 0.00
   7 -1.108024234e+09 +1.22904657e+09 1.03e+03 1.0e+01 4.5e-01 0.845 0.742 0.00
   8 -1.107844540e+09 +1.22868719e+09 6.58e+02 8.6e+00 3.9e-01 0.845 0.732 0.00
   9 -1.107718847e+09 +1.22843580e+09 4.20e+02 7.0e+00 3.3e-01 0.844 0.729 0.00
  10 -1.107625308e+09 +1.22824872e+09 2.74e+02 5.9e+00 2.7e-01 0.844 0.727 0.00
  11 -1.107552734e+09 +1.22810358e+09 2.30e+02 5.1e+00 2.3e-01 0.843 0.727 0.00
  12 -1.107494899e+09 +1.22798791e+09 2.28e+02 4.4e+00 1.9e-01 0.842 0.727 0.00
  13 -1.107447614e+09 +1.22789334e+09 2.24e+02 3.6e+00 1.5e-01 0.841 0.728 0.00
  14 -1.107407998e+09 +1.22781410e+09 2.17e+02 3.0e+00 1.3e-01 0.840 0.728 0.00
  15 -1.107374010e+09 +1.22774613e+09 2.09e+02 2.6e+00 1.1e-01 0.839 0.729 0.00
  16 -1.107344212e+09 +1.22768653e+09 1.98e+02 2.2e+00 9.8e-02 0.838 0.729 0.00
  17 -1.107317603e+09 +1.22763331e+09 1.86e+02 1.9e+00 8.8e-02 0.837 0.730 0.00
  18 -1.107293411e+09 +1.22758493e+09 1.85e+02 1.8e+00 8.0e-02 0.837 0.731 0.00
  19 -1.107271027e+09 +1.22754016e+09 2.31e+02 1.7e+00 7.5e-02 0.836 0.731 0.00
  20 -1.107249929e+09 +1.22749797e+09 2.87e+02 1.6e+00 7.2e-02 0.835 0.732 0.00
  21 -1.107229746e+09 +1.22745760e+09 3.54e+02 1.6e+00 7.0e-02 0.834 0.732 0.00
  22 -1.107210266e+09 +1.22741864e+09 4.29e+02 1.6e+00 6.9e-02 0.833 0.733 0.00
  23 -1.107190936e+09 +1.22737998e+09 5.06e+02 1.6e+00 6.9e-02 0.832 0.733 0.00
  24 -1.107171453e+09 +1.22734101e+09 5.70e+02 1.6e+00 6.9e-02 0.832 0.734 0.00
  25 -1.107151393e+09 +1.22730089e+09 5.94e+02 1.5e+00 7.1e-02 0.831 0.734 0.00
  26 -1.107130437e+09 +1.22725898e+09 5.47e+02 1.5e+00 7.7e-02 0.830 0.734 0.00
  27 -1.107108530e+09 +1.22721517e+09 4.24e+02 1.3e+00 7.8e-02 0.830 0.735 0.00
  28 -1.107085952e+09 +1.22717001e+09 2.63e+02 1.4e+00 8.0e-02 0.829 0.735 0.00
  29 -1.107063223e+09 +1.22712455e+09 1.29e+02 1.4e+00 8.2e-02 0.829 0.736 0.00
  30 -1.107040913e+09 +1.22707993e+09 1.59e+02 1.5e+00 8.4e-02 0.828 0.736 0.00
  31 -1.107019453e+09 +1.22703701e+09 1.88e+02 1.6e+00 8.3e-02 0.828 0.737 0.00
  32 -1.106999054e+09 +1.22699621e+09 1.97e+02 1.6e+00 8.4e-02 0.828 0.738 0.00
  33 -1.106979730e+09 +1.22695757e+09 1.88e+02 1.7e+00 8.5e-02 0.828 0.738 0.00
  34 -1.106961370e+09 +1.22692085e+09 1.78e+02 1.7e+00 8.5e-02 0.827 0.739 0.00
  35 -1.106943837e+09 +1.22688578e+09 1.92e+02 1.7e+00 8.5e-02 0.827 0.739 0.00
  36 -1.106926956e+09 +1.22685202e+09 2.00e+02 1.7e+00 8.5e-02 0.827 0.740 0.00
  37 -1.106910508e+09 +1.22681912e+09 2.97e+02 1.8e+00 8.5e-02 0.827 0.740 0.00
  38 -1.106894258e+09 +1.22678662e+09 3.63e+02 1.8e+00 8.6e-02 0.826 0.741 0.00
  39 -1.106877955e+09 +1.22675402e+09 3.71e+02 1.9e+00 8.6e-02 0.826 0.742 0.00
  40 -1.106861361e+09 +1.22672083e+09 3.21e+02 1.9e+00 8.7e-02 0.826 0.742 0.00
  41 -1.106844306e+09 +1.22668672e+09 2.32e+02 2.0e+00 9.2e-02 0.826 0.743 0.00
  42 -1.106826748e+09 +1.22665160e+09 1.41e+02 2.1e+00 9.4e-02 0.826 0.743 0.00
  43 -1.106808811e+09 +1.22661573e+09 1.44e+02 2.2e+00 9.2e-02 0.825 0.744 0.00
  44 -1.106790837e+09 +1.22657978e+09 1.31e+02 2.2e+00 9.4e-02 0.825 0.745 0.00
  45 -1.106773230e+09 +1.22654457e+09 1.13e+02 2.2e+00 9.5e-02 0.825 0.745 0.00
  46 -1.106756277e+09 +1.22651066e+09 9.93e+01 2.2e+00 9.5e-02 0.825 0.746 0.00
  47 -1.106740124e+09 +1.22647836e+09 9.58e+01 2.2e+00 9.4e-02 0.825 0.747 0.00
  48 -1.106724746e+09 +1.22644760e+09 1.68e+02 2.2e+00 9.3e-02 0.825 0.747 0.00
  49 -1.106710118e+09 +1.22641834e+09 1.64e+02 2.3e+00 9.1e-02 0.824 0.748 0.00
  50 -1.106696443e+09 +1.22639099e+09 1.46e+02 2.4e+00 9.0e-02 0.824 0.748 0.00
  51 -1.106683514e+09 +1.22636514e+09 1.16e+02 2.4e+00 8.8e-02 0.824 0.748 0.00
  52 -1.106671231e+09 +1.22634057e+09 8.94e+01 2.3e+00 8.6e-02 0.824 0.749 0.00
  53 -1.106659483e+09 +1.22631707e+09 8.88e+01 2.3e+00 8.3e-02 0.824 0.749 0.00
  54 -1.106648247e+09 +1.22629460e+09 8.81e+01 2.2e+00 8.1e-02 0.824 0.749 0.00
  55 -1.106637524e+09 +1.22627315e+09 8.73e+01 2.2e+00 7.9e-02 0.824 0.749 0.00
  56 -1.106627316e+09 +1.22625274e+09 8.62e+01 2.2e+00 7.7e-02 0.824 0.749 0.00
  57 -1.106617628e+09 +1.22623336e+09 8.51e+01 2.1e+00 7.6e-02 0.823 0.750 0.00
  58 -1.106608464e+09 +1.22621504e+09 8.41e+01 2.1e+00 7.4e-02 0.823 0.750 0.00
  59 -1.106599812e+09 +1.22619773e+09 8.31e+01 2.0e+00 7.2e-02 0.823 0.750 0.00
  60 -1.106591646e+09 +1.22618140e+09 8.20e+01 1.9e+00 7.0e-02 0.823 0.750 0.00
  61 -1.106583945e+09 +1.22616600e+09 8.28e+01 1.9e+00 6.8e-02 0.823 0.750 0.00
  62 -1.106576687e+09 +1.22615148e+09 8.48e+01 1.8e+00 6.6e-02 0.823 0.751 0.00
  63 -1.106569851e+09 +1.22613781e+09 8.67e+01 1.8e+00 6.4e-02 0.823 0.751 0.00
  64 -1.106563414e+09 +1.22612494e+09 8.85e+01 1.7e+00 6.2e-02 0.823 0.751 0.00
  65 -1.106557350e+09 +1.22611281e+09 9.01e+01 1.6e+00 6.0e-02 0.823 0.751 0.00
  66 -1.106551635e+09 +1.22610138e+09 9.15e+01 1.6e+00 5.8e-02 0.823 0.751 0.00
  67 -1.106546244e+09 +1.22609060e+09 9.30e+01 1.5e+00 5.6e-02 0.823 0.752 0.00
  68 -1.106541150e+09 +1.22608041e+09 9.43e+01 1.5e+00 5.5e-02 0.823 0.752 0.00
  69 -1.106536333e+09 +1.22607077e+09 9.55e+01 1.4e+00 5.3e-02 0.823 0.752 0.00
  70 -1.106531773e+09 +1.22606165e+09 9.66e+01 1.4e+00 5.1e-02 0.822 0.752 0.00
  71 -1.106527451e+09 +1.22605301e+09 9.76e+01 1.3e+00 5.0e-02 0.822 0.752 0.00
  72 -1.106523345e+09 +1.22604480e+09 9.85e+01 1.3e+00 4.9e-02 0.822 0.752 0.00
  73 -1.106519440e+09 +1.22603699e+09 9.93e+01 1.3e+00 4.7e-02 0.822 0.753 0.00
  74 -1.106515719e+09 +1.22602955e+09 1.00e+02 1.2e+00 4.6e-02 0.822 0.753 0.00
  75 -1.106512168e+09 +1.22602244e+09 1.01e+02 1.2e+00 4.5e-02 0.822 0.753 0.00
  76 -1.106508780e+09 +1.22601567e+09 1.02e+02 1.2e+00 4.3e-02 0.822 0.753 0.00
  77 -1.106505555e+09 +1.22600922e+09 1.02e+02 1.1e+00 4.2e-02 0.822 0.753 0.00
  78 -1.106502481e+09 +1.22600307e+09 1.02e+02 1.1e+00 4.1e-02 0.822 0.753 0.00
  79 -1.106499547e+09 +1.22599720e+09 1.03e+02 1.1e+00 4.0e-02 0.822 0.753 0.00
  80 -1.106496741e+09 +1.22599159e+09 1.03e+02 1.1e+00 3.9e-02 0.822 0.754 0.00
  81 -1.106494052e+09 +1.22598621e+09 1.03e+02 1.0e+00 3.8e-02 0.822 0.754 0.00
  82 -1.106491472e+09 +1.22598105e+09 1.03e+02 1.0e+00 3.7e-02 0.822 0.754 0.00
  83 -1.106488985e+09 +1.22597608e+09 1.03e+02 9.8e-01 3.6e-02 0.822 0.754 0.00
  84 -1.106486585e+09 +1.22597128e+09 1.03e+02 9.6e-01 3.5e-02 0.822 0.754 0.00
  85 -1.106484271e+09 +1.22596665e+09 1.03e+02 9.5e-01 3.4e-02 0.821 0.754 0.00
  86 -1.106482038e+09 +1.22596218e+09 1.03e+02 9.3e-01 3.3e-02 0.821 0.754 0.00
  87 -1.106479878e+09 +1.22595786e+09 1.03e+02 9.1e-01 3.3e-02 0.821 0.754 0.00
  88 -1.106477787e+09 +1.22595368e+09 1.03e+02 9.0e-01 3.2e-02 0.821 0.755 0.00
  89 -1.106475761e+09 +1.22594963e+09 1.03e+02 8.8e-01 3.1e-02 0.821 0.755 0.00
  90 -1.106473794e+09 +1.22594570e+09 1.03e+02 8.7e-01 3.1e-02 0.821 0.755 0.00
  91 -1.106471885e+09 +1.22594188e+09 1.02e+02 8.5e-01 3.0e-02 0.821 0.755 0.00
  92 -1.106470026e+09 +1.22593816e+09 1.02e+02 8.4e-01 3.0e-02 0.821 0.755 0.00
  93 -1.106468211e+09 +1.22593453e+09 1.02e+02 8.3e-01 2.9e-02 0.821 0.755 0.00
  94 -1.106466435e+09 +1.22593098e+09 1.02e+02 8.2e-01 2.9e-02 0.821 0.755 0.00
  95 -1.106464696e+09 +1.22592750e+09 1.02e+02 8.1e-01 2.8e-02 0.821 0.755 0.00
  96 -1.106462991e+09 +1.22592409e+09 1.02e+02 8.0e-01 2.8e-02 0.821 0.755 0.00
  97 -1.106461319e+09 +1.22592075e+09 1.02e+02 8.0e-01 2.8e-02 0.820 0.755 0.00
  98 -1.106459679e+09 +1.22591746e+09 1.01e+02 7.9e-01 2.7e-02 0.820 0.755 0.00
  99 -1.106458069e+09 +1.22591424e+09 1.01e+02 7.8e-01 2.7e-02 0.820 0.756 0.00
 100 -1.106456489e+09 +1.22591109e+09 1.01e+02 7.7e-01 2.7e-02 0.820 0.756 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
80786.233  8532.828 43829.088 
