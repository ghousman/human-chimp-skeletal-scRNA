
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 5"
> print(paste0("data source: ",data.source))
[1] "data source: t2"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-5 Poisson NMF to 27151 x 17304 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -2.546651708e+08 +3.01136163e+08 9.35e+03 2.6e+02 9.8e-01 0.758 0.685 0.00
   2 -2.514057049e+08 +2.94617232e+08 4.05e+03 3.2e+01 3.3e+00 0.780 0.827 0.00
   3 -2.501117728e+08 +2.92029368e+08 5.60e+03 2.9e+01 2.0e+00 0.781 0.777 0.00
   4 -2.493411056e+08 +2.90488033e+08 1.44e+03 2.5e+01 1.1e+00 0.785 0.791 0.00
   5 -2.487786126e+08 +2.89363047e+08 1.05e+03 2.0e+01 4.6e-01 0.788 0.801 0.00
   6 -2.483380546e+08 +2.88481931e+08 1.57e+03 2.1e+01 4.0e-01 0.790 0.810 0.00
   7 -2.479986445e+08 +2.87803111e+08 2.41e+03 2.4e+01 5.0e-01 0.791 0.815 0.00
   8 -2.477585856e+08 +2.87322993e+08 3.23e+03 2.4e+01 5.2e-01 0.792 0.819 0.00
   9 -2.475983124e+08 +2.87002447e+08 3.66e+03 2.2e+01 2.2e-01 0.792 0.821 0.00
  10 -2.474910012e+08 +2.86787824e+08 3.57e+03 2.0e+01 1.8e-01 0.792 0.822 0.00
  11 -2.474194311e+08 +2.86644684e+08 3.07e+03 1.7e+01 1.4e-01 0.791 0.821 0.00
  12 -2.473712277e+08 +2.86548277e+08 2.36e+03 1.4e+01 1.1e-01 0.791 0.820 0.00
  13 -2.473386181e+08 +2.86483058e+08 1.84e+03 1.1e+01 9.5e-02 0.790 0.819 0.00
  14 -2.473161273e+08 +2.86438076e+08 1.44e+03 9.2e+00 8.3e-02 0.790 0.819 0.00
  15 -2.473005624e+08 +2.86406947e+08 1.10e+03 7.5e+00 7.1e-02 0.789 0.818 0.00
  16 -2.472897980e+08 +2.86385418e+08 8.26e+02 6.1e+00 5.9e-02 0.789 0.817 0.00
  17 -2.472823340e+08 +2.86370490e+08 6.25e+02 5.0e+00 4.7e-02 0.789 0.816 0.00
  18 -2.472771409e+08 +2.86360104e+08 5.33e+02 4.1e+00 3.9e-02 0.789 0.816 0.00
  19 -2.472734889e+08 +2.86352800e+08 4.47e+02 3.4e+00 3.2e-02 0.789 0.815 0.00
  20 -2.472708837e+08 +2.86347589e+08 3.70e+02 2.8e+00 2.5e-02 0.789 0.814 0.00
  21 -2.472689970e+08 +2.86343816e+08 3.05e+02 2.3e+00 2.1e-02 0.789 0.814 0.00
  22 -2.472676036e+08 +2.86341029e+08 2.52e+02 1.9e+00 1.7e-02 0.789 0.814 0.00
  23 -2.472665589e+08 +2.86338940e+08 2.08e+02 1.6e+00 1.4e-02 0.789 0.813 0.00
  24 -2.472657692e+08 +2.86337360e+08 1.73e+02 1.3e+00 1.2e-02 0.789 0.813 0.00
  25 -2.472651644e+08 +2.86336151e+08 1.46e+02 1.1e+00 1.0e-02 0.789 0.813 0.00
  26 -2.472646957e+08 +2.86335213e+08 1.24e+02 9.6e-01 8.3e-03 0.789 0.813 0.00
  27 -2.472643301e+08 +2.86334482e+08 1.06e+02 8.1e-01 7.0e-03 0.789 0.813 0.00
  28 -2.472640440e+08 +2.86333910e+08 9.18e+01 6.9e-01 6.0e-03 0.789 0.813 0.00
  29 -2.472638196e+08 +2.86333461e+08 7.93e+01 5.9e-01 5.1e-03 0.789 0.812 0.00
  30 -2.472636427e+08 +2.86333107e+08 6.86e+01 5.0e-01 4.5e-03 0.789 0.812 0.00
  31 -2.472635025e+08 +2.86332827e+08 5.97e+01 4.3e-01 4.0e-03 0.789 0.812 0.00
  32 -2.472633906e+08 +2.86332603e+08 5.23e+01 3.6e-01 3.6e-03 0.789 0.812 0.00
  33 -2.472633008e+08 +2.86332424e+08 4.60e+01 3.1e-01 3.2e-03 0.789 0.812 0.00
  34 -2.472632284e+08 +2.86332279e+08 4.06e+01 2.6e-01 2.8e-03 0.789 0.812 0.00
  35 -2.472631697e+08 +2.86332161e+08 3.60e+01 2.2e-01 2.5e-03 0.789 0.812 0.00
  36 -2.472631218e+08 +2.86332066e+08 3.20e+01 1.9e-01 2.2e-03 0.789 0.812 0.00
  37 -2.472630824e+08 +2.86331987e+08 2.85e+01 1.6e-01 2.0e-03 0.789 0.812 0.00
  38 -2.472630498e+08 +2.86331922e+08 2.54e+01 1.3e-01 1.8e-03 0.789 0.812 0.00
  39 -2.472630227e+08 +2.86331867e+08 2.27e+01 1.1e-01 1.6e-03 0.789 0.812 0.00
  40 -2.472629999e+08 +2.86331822e+08 2.03e+01 9.6e-02 1.4e-03 0.789 0.812 0.00
  41 -2.472629815e+08 +2.86331785e+08 1.82e+01 1.5e-01 1.3e-03 0.789 0.812 0.00
  42 -2.472629695e+08 +2.86331761e+08 1.64e+01 1.8e-01 1.2e-03 0.789 0.812 0.00
  43 -2.472629602e+08 +2.86331742e+08 1.48e+01 1.5e-01 1.1e-03 0.789 0.812 0.00
  44 -2.472629528e+08 +2.86331728e+08 1.33e+01 1.3e-01 9.3e-04 0.789 0.812 0.00
  45 -2.472629468e+08 +2.86331715e+08 1.20e+01 1.1e-01 8.4e-04 0.789 0.812 0.00
  46 -2.472629419e+08 +2.86331706e+08 1.07e+01 9.8e-02 7.6e-04 0.789 0.812 0.00
  47 -2.472629379e+08 +2.86331698e+08 9.65e+00 8.6e-02 6.8e-04 0.789 0.812 0.00
  48 -2.472629347e+08 +2.86331691e+08 8.68e+00 7.6e-02 6.2e-04 0.789 0.812 0.00
  49 -2.472629320e+08 +2.86331686e+08 7.81e+00 6.7e-02 5.6e-04 0.789 0.812 0.00
  50 -2.472629299e+08 +2.86331682e+08 7.05e+00 5.9e-02 5.0e-04 0.789 0.812 0.00
  51 -2.472629281e+08 +2.86331678e+08 6.36e+00 5.2e-02 4.5e-04 0.789 0.812 0.00
  52 -2.472629267e+08 +2.86331675e+08 5.74e+00 4.6e-02 4.1e-04 0.789 0.812 0.00
  53 -2.472629255e+08 +2.86331673e+08 5.19e+00 4.1e-02 3.8e-04 0.789 0.812 0.00
  54 -2.472629245e+08 +2.86331671e+08 4.69e+00 3.6e-02 3.4e-04 0.789 0.812 0.00
  55 -2.472629238e+08 +2.86331669e+08 4.24e+00 3.2e-02 3.1e-04 0.789 0.812 0.00
  56 -2.472629231e+08 +2.86331668e+08 3.84e+00 2.9e-02 2.9e-04 0.789 0.812 0.00
  57 -2.472629226e+08 +2.86331667e+08 3.47e+00 2.5e-02 2.6e-04 0.789 0.812 0.00
  58 -2.472629222e+08 +2.86331666e+08 3.14e+00 2.3e-02 2.4e-04 0.789 0.812 0.00
  59 -2.472629218e+08 +2.86331666e+08 2.84e+00 2.0e-02 2.2e-04 0.789 0.812 0.00
  60 -2.472629215e+08 +2.86331665e+08 2.58e+00 1.8e-02 2.0e-04 0.789 0.812 0.00
  61 -2.472629213e+08 +2.86331664e+08 2.33e+00 1.6e-02 1.8e-04 0.789 0.812 0.00
  62 -2.472629211e+08 +2.86331664e+08 2.12e+00 1.4e-02 1.6e-04 0.789 0.812 0.00
  63 -2.472629209e+08 +2.86331664e+08 1.92e+00 1.3e-02 1.5e-04 0.789 0.812 0.00
  64 -2.472629208e+08 +2.86331663e+08 1.74e+00 1.1e-02 1.3e-04 0.789 0.812 0.00
  65 -2.472629207e+08 +2.86331663e+08 1.58e+00 1.0e-02 1.2e-04 0.789 0.812 0.00
  66 -2.472629206e+08 +2.86331663e+08 1.43e+00 9.0e-03 1.1e-04 0.789 0.812 0.00
  67 -2.472629205e+08 +2.86331663e+08 1.30e+00 8.1e-03 1.0e-04 0.789 0.812 0.00
  68 -2.472629205e+08 +2.86331663e+08 1.18e+00 7.2e-03 9.1e-05 0.789 0.812 0.00
  69 -2.472629204e+08 +2.86331663e+08 1.07e+00 6.4e-03 8.2e-05 0.789 0.812 0.00
  70 -2.472629204e+08 +2.86331663e+08 9.74e-01 5.8e-03 7.5e-05 0.789 0.812 0.00
  71 -2.472629203e+08 +2.86331663e+08 8.85e-01 5.2e-03 6.8e-05 0.789 0.812 0.00
  72 -2.472629203e+08 +2.86331663e+08 8.03e-01 4.7e-03 6.2e-05 0.789 0.812 0.00
  73 -2.472629203e+08 +2.86331662e+08 7.30e-01 4.2e-03 5.6e-05 0.789 0.812 0.00
  74 -2.472629203e+08 +2.86331662e+08 6.62e-01 3.8e-03 5.1e-05 0.789 0.812 0.00
  75 -2.472629202e+08 +2.86331662e+08 6.01e-01 3.4e-03 4.6e-05 0.789 0.812 0.00
  76 -2.472629202e+08 +2.86331662e+08 5.46e-01 3.0e-03 4.2e-05 0.789 0.812 0.00
  77 -2.472629202e+08 +2.86331662e+08 4.96e-01 2.7e-03 3.8e-05 0.789 0.812 0.00
  78 -2.472629202e+08 +2.86331662e+08 4.51e-01 2.5e-03 3.4e-05 0.789 0.812 0.00
  79 -2.472629202e+08 +2.86331662e+08 4.09e-01 2.2e-03 3.1e-05 0.789 0.812 0.00
  80 -2.472629202e+08 +2.86331662e+08 3.72e-01 2.0e-03 2.8e-05 0.789 0.812 0.00
  81 -2.472629202e+08 +2.86331662e+08 3.38e-01 1.8e-03 2.6e-05 0.789 0.812 0.00
  82 -2.472629202e+08 +2.86331662e+08 3.07e-01 1.6e-03 2.3e-05 0.789 0.812 0.00
  83 -2.472629202e+08 +2.86331662e+08 2.79e-01 1.5e-03 2.1e-05 0.789 0.812 0.00
  84 -2.472629202e+08 +2.86331662e+08 2.54e-01 1.3e-03 1.9e-05 0.789 0.812 0.00
  85 -2.472629202e+08 +2.86331662e+08 2.31e-01 1.2e-03 1.7e-05 0.789 0.812 0.00
  86 -2.472629202e+08 +2.86331662e+08 2.10e-01 1.1e-03 1.6e-05 0.789 0.812 0.00
  87 -2.472629202e+08 +2.86331662e+08 1.91e-01 9.6e-04 1.4e-05 0.789 0.812 0.00
  88 -2.472629202e+08 +2.86331662e+08 1.73e-01 8.7e-04 1.3e-05 0.789 0.812 0.00
  89 -2.472629202e+08 +2.86331662e+08 1.58e-01 7.8e-04 1.2e-05 0.789 0.812 0.00
  90 -2.472629202e+08 +2.86331662e+08 1.43e-01 7.0e-04 1.1e-05 0.789 0.812 0.00
  91 -2.472629202e+08 +2.86331662e+08 1.30e-01 6.4e-04 9.6e-06 0.789 0.812 0.00
  92 -2.472629202e+08 +2.86331662e+08 1.19e-01 5.7e-04 8.7e-06 0.789 0.812 0.00
  93 -2.472629202e+08 +2.86331662e+08 1.08e-01 5.2e-04 8.4e-06 0.789 0.812 0.00
  94 -2.472629202e+08 +2.86331662e+08 9.84e-02 4.7e-04 8.3e-06 0.789 0.812 0.00
  95 -2.472629202e+08 +2.86331662e+08 8.95e-02 4.2e-04 8.2e-06 0.789 0.812 0.00
  96 -2.472629202e+08 +2.86331662e+08 8.15e-02 3.8e-04 8.0e-06 0.789 0.812 0.00
  97 -2.472629202e+08 +2.86331662e+08 7.42e-02 3.5e-04 7.9e-06 0.789 0.812 0.00
  98 -2.472629202e+08 +2.86331662e+08 6.76e-02 3.1e-04 7.8e-06 0.789 0.812 0.00
  99 -2.472629202e+08 +2.86331662e+08 6.15e-02 2.9e-04 7.7e-06 0.789 0.812 0.00
 100 -2.472629202e+08 +2.86331662e+08 5.60e-02 2.6e-04 7.6e-06 0.789 0.812 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
    user   system  elapsed 
16306.59  1627.77 10690.68 
