
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 9"
> print(paste0("data source: ",data.source))
[1] "data source: t2"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-9 Poisson NMF to 27151 x 17304 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -2.492869824e+08 +2.90379787e+08 3.30e+04 1.8e+02 1.6e+00 0.689 0.599 0.00
   2 -2.418799059e+08 +2.75565634e+08 1.66e+04 6.8e+01 3.3e+00 0.680 0.793 0.00
   3 -2.394658574e+08 +2.70737537e+08 6.85e+03 4.7e+01 2.0e+00 0.677 0.688 0.00
   4 -2.385676210e+08 +2.68941064e+08 6.64e+03 3.6e+01 1.4e+00 0.677 0.697 0.00
   5 -2.380987311e+08 +2.68003284e+08 3.88e+03 3.1e+01 8.4e-01 0.680 0.698 0.00
   6 -2.377879708e+08 +2.67381763e+08 3.71e+03 2.9e+01 6.8e-01 0.681 0.697 0.00
   7 -2.375497698e+08 +2.66905362e+08 3.73e+03 2.7e+01 5.8e-01 0.682 0.694 0.00
   8 -2.373344318e+08 +2.66474686e+08 3.33e+03 2.5e+01 4.3e-01 0.682 0.691 0.00
   9 -2.370766583e+08 +2.65959139e+08 3.13e+03 2.4e+01 3.9e-01 0.683 0.691 0.00
  10 -2.366315770e+08 +2.65068976e+08 3.59e+03 4.3e+01 3.5e-01 0.683 0.693 0.00
  11 -2.361516650e+08 +2.64109152e+08 1.73e+03 1.7e+01 5.4e-01 0.686 0.702 0.00
  12 -2.358722348e+08 +2.63550292e+08 2.99e+03 1.0e+01 5.1e-01 0.684 0.698 0.00
  13 -2.356389320e+08 +2.63083686e+08 2.57e+03 1.1e+01 5.7e-01 0.684 0.695 0.00
  14 -2.354375037e+08 +2.62680829e+08 2.26e+03 1.4e+01 5.9e-01 0.685 0.694 0.00
  15 -2.352755017e+08 +2.62356825e+08 1.98e+03 1.4e+01 7.5e-01 0.685 0.690 0.00
  16 -2.351500829e+08 +2.62105988e+08 1.64e+03 1.3e+01 8.3e-01 0.687 0.687 0.00
  17 -2.350563630e+08 +2.61918548e+08 1.25e+03 1.0e+01 6.5e-01 0.689 0.684 0.00
  18 -2.349832298e+08 +2.61772282e+08 9.09e+02 1.2e+01 4.2e-01 0.691 0.681 0.00
  19 -2.349011857e+08 +2.61608193e+08 7.23e+02 2.2e+01 3.6e-01 0.694 0.679 0.00
  20 -2.347968880e+08 +2.61399598e+08 6.23e+02 1.1e+01 1.0e+00 0.696 0.678 0.00
  21 -2.347434019e+08 +2.61292626e+08 6.11e+02 5.2e+00 6.9e-01 0.699 0.677 0.00
  22 -2.347156867e+08 +2.61237195e+08 5.50e+02 5.7e+00 1.6e-01 0.700 0.675 0.00
  23 -2.346950564e+08 +2.61195935e+08 4.67e+02 6.3e+00 1.1e-01 0.701 0.674 0.00
  24 -2.346769353e+08 +2.61159692e+08 3.92e+02 7.0e+00 1.1e-01 0.702 0.674 0.00
  25 -2.346597008e+08 +2.61125224e+08 3.30e+02 7.8e+00 1.2e-01 0.703 0.674 0.00
  26 -2.346426150e+08 +2.61091052e+08 2.75e+02 8.6e+00 1.3e-01 0.703 0.674 0.00
  27 -2.346250579e+08 +2.61055938e+08 2.79e+02 9.4e+00 1.4e-01 0.704 0.674 0.00
  28 -2.346066537e+08 +2.61019129e+08 2.79e+02 1.0e+01 1.4e-01 0.704 0.675 0.00
  29 -2.345871747e+08 +2.60980171e+08 3.52e+02 1.0e+01 1.5e-01 0.704 0.676 0.00
  30 -2.345666778e+08 +2.60939177e+08 4.31e+02 1.1e+01 1.4e-01 0.704 0.676 0.00
  31 -2.345453685e+08 +2.60896559e+08 4.34e+02 1.1e+01 1.3e-01 0.704 0.677 0.00
  32 -2.345235013e+08 +2.60852824e+08 3.94e+02 1.0e+01 1.2e-01 0.703 0.678 0.00
  33 -2.345012806e+08 +2.60808383e+08 4.63e+02 1.0e+01 1.1e-01 0.703 0.679 0.00
  34 -2.344789739e+08 +2.60763770e+08 5.37e+02 9.7e+00 1.1e-01 0.703 0.680 0.00
  35 -2.344570088e+08 +2.60719840e+08 6.12e+02 9.2e+00 1.1e-01 0.703 0.680 0.00
  36 -2.344358663e+08 +2.60677554e+08 6.82e+02 8.6e+00 1.1e-01 0.702 0.682 0.00
  37 -2.344159750e+08 +2.60637772e+08 7.40e+02 8.0e+00 1.1e-01 0.702 0.683 0.00
  38 -2.343975847e+08 +2.60600991e+08 7.85e+02 7.3e+00 1.1e-01 0.702 0.683 0.00
  39 -2.343808782e+08 +2.60567578e+08 8.08e+02 6.6e+00 1.1e-01 0.702 0.684 0.00
  40 -2.343659447e+08 +2.60537711e+08 8.07e+02 5.9e+00 1.0e-01 0.702 0.685 0.00
  41 -2.343527171e+08 +2.60511256e+08 7.83e+02 5.2e+00 9.7e-02 0.702 0.686 0.00
  42 -2.343410846e+08 +2.60487991e+08 7.42e+02 4.6e+00 9.1e-02 0.702 0.686 0.00
  43 -2.343308474e+08 +2.60467517e+08 6.89e+02 4.0e+00 8.4e-02 0.702 0.687 0.00
  44 -2.343218335e+08 +2.60449489e+08 6.27e+02 3.5e+00 7.7e-02 0.702 0.687 0.00
  45 -2.343138670e+08 +2.60433556e+08 5.62e+02 3.0e+00 7.0e-02 0.702 0.688 0.00
  46 -2.343067878e+08 +2.60419398e+08 4.97e+02 2.6e+00 6.3e-02 0.702 0.689 0.00
  47 -2.343004593e+08 +2.60406741e+08 4.36e+02 2.3e+00 5.9e-02 0.703 0.689 0.00
  48 -2.342947482e+08 +2.60395318e+08 3.81e+02 2.0e+00 5.7e-02 0.703 0.690 0.00
  49 -2.342895641e+08 +2.60384950e+08 3.32e+02 1.7e+00 5.5e-02 0.703 0.690 0.00
  50 -2.342848464e+08 +2.60375515e+08 2.87e+02 1.6e+00 5.3e-02 0.704 0.690 0.00
  51 -2.342804890e+08 +2.60366800e+08 2.48e+02 1.4e+00 5.1e-02 0.704 0.691 0.00
  52 -2.342764129e+08 +2.60358648e+08 2.15e+02 1.3e+00 4.9e-02 0.705 0.691 0.00
  53 -2.342725574e+08 +2.60350937e+08 1.88e+02 1.3e+00 4.6e-02 0.705 0.691 0.00
  54 -2.342688775e+08 +2.60343577e+08 1.65e+02 1.3e+00 4.4e-02 0.706 0.691 0.00
  55 -2.342653383e+08 +2.60336499e+08 1.46e+02 1.3e+00 4.2e-02 0.706 0.692 0.00
  56 -2.342619135e+08 +2.60329649e+08 1.31e+02 1.3e+00 4.0e-02 0.707 0.692 0.00
  57 -2.342585867e+08 +2.60322995e+08 1.22e+02 1.4e+00 3.8e-02 0.707 0.692 0.00
  58 -2.342553337e+08 +2.60316489e+08 1.20e+02 1.4e+00 3.7e-02 0.708 0.692 0.00
  59 -2.342521315e+08 +2.60310085e+08 1.21e+02 1.4e+00 3.5e-02 0.708 0.692 0.00
  60 -2.342489660e+08 +2.60303754e+08 1.20e+02 1.5e+00 3.4e-02 0.709 0.692 0.00
  61 -2.342458268e+08 +2.60297475e+08 1.19e+02 1.5e+00 3.4e-02 0.710 0.692 0.00
  62 -2.342427072e+08 +2.60291236e+08 1.16e+02 1.5e+00 3.5e-02 0.710 0.692 0.00
  63 -2.342396017e+08 +2.60285025e+08 1.13e+02 1.5e+00 3.5e-02 0.711 0.692 0.00
  64 -2.342365056e+08 +2.60278833e+08 1.11e+02 1.5e+00 3.6e-02 0.711 0.692 0.00
  65 -2.342334129e+08 +2.60272648e+08 1.08e+02 1.6e+00 3.6e-02 0.712 0.692 0.00
  66 -2.342303182e+08 +2.60266458e+08 1.05e+02 1.6e+00 3.7e-02 0.713 0.692 0.00
  67 -2.342272180e+08 +2.60260258e+08 1.02e+02 1.6e+00 3.7e-02 0.714 0.692 0.00
  68 -2.342241088e+08 +2.60254040e+08 7.59e+01 1.6e+00 3.8e-02 0.714 0.692 0.00
  69 -2.342209873e+08 +2.60247797e+08 7.42e+01 1.6e+00 3.9e-02 0.715 0.692 0.00
  70 -2.342178614e+08 +2.60241545e+08 7.17e+01 1.6e+00 4.0e-02 0.715 0.692 0.00
  71 -2.342147576e+08 +2.60235337e+08 6.89e+01 1.7e+00 4.0e-02 0.716 0.692 0.00
  72 -2.342116822e+08 +2.60229186e+08 6.70e+01 1.7e+00 4.0e-02 0.717 0.692 0.00
  73 -2.342086260e+08 +2.60223074e+08 6.57e+01 1.7e+00 4.0e-02 0.717 0.692 0.00
  74 -2.342055865e+08 +2.60216995e+08 6.46e+01 1.7e+00 4.1e-02 0.718 0.692 0.00
  75 -2.342025635e+08 +2.60210949e+08 6.45e+01 1.7e+00 4.1e-02 0.719 0.692 0.00
  76 -2.341995573e+08 +2.60204937e+08 6.45e+01 1.7e+00 4.2e-02 0.719 0.692 0.00
  77 -2.341965716e+08 +2.60198965e+08 6.43e+01 1.6e+00 4.2e-02 0.720 0.691 0.00
  78 -2.341936135e+08 +2.60193049e+08 6.42e+01 1.6e+00 4.2e-02 0.720 0.691 0.00
  79 -2.341906888e+08 +2.60187200e+08 6.47e+01 1.6e+00 4.3e-02 0.721 0.691 0.00
  80 -2.341878007e+08 +2.60181423e+08 6.56e+01 1.6e+00 4.3e-02 0.721 0.691 0.00
  81 -2.341849596e+08 +2.60175741e+08 6.64e+01 1.6e+00 4.3e-02 0.722 0.691 0.00
  82 -2.341821768e+08 +2.60170176e+08 6.70e+01 1.6e+00 4.3e-02 0.723 0.691 0.00
  83 -2.341794633e+08 +2.60164749e+08 6.74e+01 1.6e+00 4.3e-02 0.723 0.690 0.00
  84 -2.341768353e+08 +2.60159492e+08 6.73e+01 1.6e+00 4.3e-02 0.724 0.690 0.00
  85 -2.341743144e+08 +2.60154451e+08 6.68e+01 1.6e+00 4.3e-02 0.724 0.690 0.00
  86 -2.341719185e+08 +2.60149659e+08 6.62e+01 1.6e+00 4.2e-02 0.725 0.690 0.00
  87 -2.341696606e+08 +2.60145143e+08 6.54e+01 1.5e+00 4.1e-02 0.725 0.689 0.00
  88 -2.341675526e+08 +2.60140927e+08 6.43e+01 1.5e+00 4.1e-02 0.726 0.689 0.00
  89 -2.341655993e+08 +2.60137021e+08 6.30e+01 1.5e+00 3.9e-02 0.726 0.689 0.00
  90 -2.341637992e+08 +2.60133420e+08 6.17e+01 1.4e+00 3.8e-02 0.727 0.688 0.00
  91 -2.341621503e+08 +2.60130123e+08 6.01e+01 1.4e+00 3.7e-02 0.727 0.688 0.00
  92 -2.341606488e+08 +2.60127120e+08 5.83e+01 1.3e+00 3.6e-02 0.728 0.688 0.00
  93 -2.341592890e+08 +2.60124400e+08 5.64e+01 1.3e+00 3.4e-02 0.728 0.687 0.00
  94 -2.341580610e+08 +2.60121944e+08 5.44e+01 1.3e+00 3.3e-02 0.728 0.687 0.00
  95 -2.341569567e+08 +2.60119735e+08 5.22e+01 1.2e+00 3.1e-02 0.729 0.687 0.00
  96 -2.341559672e+08 +2.60117756e+08 5.01e+01 1.2e+00 3.0e-02 0.729 0.687 0.00
  97 -2.341550836e+08 +2.60115989e+08 4.79e+01 1.1e+00 2.8e-02 0.729 0.686 0.00
  98 -2.341542970e+08 +2.60114416e+08 4.57e+01 1.1e+00 2.7e-02 0.729 0.686 0.00
  99 -2.341535993e+08 +2.60113020e+08 4.35e+01 1.0e+00 2.5e-02 0.729 0.686 0.00
 100 -2.341529818e+08 +2.60111786e+08 4.12e+01 9.7e-01 2.4e-02 0.730 0.685 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
    user   system  elapsed 
24885.00  1598.86 11615.53 
