
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 10"
> print(paste0("data source: ",data.source))
[1] "data source: t2"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-10 Poisson NMF to 27151 x 17304 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -2.514942551e+08 +2.94794332e+08 4.63e+04 5.0e+02 6.5e+00 0.640 0.467 0.00
   2 -2.415944864e+08 +2.74994795e+08 2.80e+04 1.6e+02 5.2e+00 0.649 0.676 0.00
   3 -2.381479455e+08 +2.68101713e+08 9.04e+03 1.2e+02 2.5e+00 0.651 0.589 0.00
   4 -2.366390791e+08 +2.65083980e+08 2.41e+03 6.0e+01 1.3e+00 0.659 0.622 0.00
   5 -2.357142100e+08 +2.63234242e+08 1.72e+03 4.9e+01 1.0e+00 0.664 0.645 0.00
   6 -2.351203719e+08 +2.62046566e+08 1.17e+03 2.2e+01 9.0e-01 0.665 0.659 0.00
   7 -2.347382955e+08 +2.61282413e+08 1.75e+03 2.0e+01 5.7e-01 0.665 0.669 0.00
   8 -2.344671505e+08 +2.60740123e+08 1.38e+03 1.8e+01 4.1e-01 0.667 0.672 0.00
   9 -2.342489361e+08 +2.60303694e+08 6.55e+02 1.7e+01 5.6e-01 0.671 0.674 0.00
  10 -2.340610672e+08 +2.59927956e+08 6.26e+02 1.5e+01 6.1e-01 0.675 0.672 0.00
  11 -2.338925416e+08 +2.59590905e+08 6.16e+02 1.4e+01 5.2e-01 0.679 0.670 0.00
  12 -2.337408334e+08 +2.59287489e+08 5.13e+02 1.3e+01 4.5e-01 0.684 0.667 0.00
  13 -2.336084283e+08 +2.59022678e+08 7.05e+02 1.2e+01 5.2e-01 0.688 0.665 0.00
  14 -2.334979363e+08 +2.58801695e+08 1.03e+03 1.1e+01 5.3e-01 0.692 0.662 0.00
  15 -2.334092299e+08 +2.58624282e+08 5.76e+02 9.9e+00 4.8e-01 0.695 0.660 0.00
  16 -2.333390990e+08 +2.58484020e+08 5.15e+02 8.4e+00 3.9e-01 0.698 0.658 0.00
  17 -2.332832306e+08 +2.58372283e+08 4.88e+02 7.9e+00 2.9e-01 0.701 0.656 0.00
  18 -2.332386749e+08 +2.58283172e+08 4.59e+02 7.2e+00 2.0e-01 0.703 0.655 0.00
  19 -2.332032205e+08 +2.58212263e+08 4.29e+02 6.5e+00 1.9e-01 0.705 0.654 0.00
  20 -2.331747317e+08 +2.58155285e+08 4.21e+02 5.8e+00 1.7e-01 0.707 0.653 0.00
  21 -2.331516812e+08 +2.58109184e+08 4.11e+02 5.2e+00 1.5e-01 0.709 0.652 0.00
  22 -2.331326966e+08 +2.58071215e+08 3.98e+02 5.4e+00 1.3e-01 0.710 0.651 0.00
  23 -2.331165890e+08 +2.58039000e+08 3.81e+02 5.7e+00 1.2e-01 0.712 0.650 0.00
  24 -2.331025918e+08 +2.58011006e+08 3.60e+02 6.0e+00 1.1e-01 0.713 0.649 0.00
  25 -2.330901440e+08 +2.57986110e+08 3.36e+02 6.2e+00 1.1e-01 0.715 0.648 0.00
  26 -2.330788425e+08 +2.57963507e+08 3.12e+02 6.5e+00 1.1e-01 0.716 0.648 0.00
  27 -2.330683956e+08 +2.57942613e+08 2.85e+02 6.8e+00 1.0e-01 0.717 0.647 0.00
  28 -2.330585649e+08 +2.57922952e+08 2.62e+02 7.0e+00 1.0e-01 0.717 0.647 0.00
  29 -2.330491799e+08 +2.57904182e+08 2.41e+02 7.2e+00 1.2e-01 0.718 0.646 0.00
  30 -2.330400681e+08 +2.57885958e+08 2.23e+02 7.3e+00 1.4e-01 0.719 0.646 0.00
  31 -2.330310244e+08 +2.57867871e+08 2.26e+02 7.5e+00 1.7e-01 0.719 0.646 0.00
  32 -2.330217872e+08 +2.57849396e+08 2.46e+02 7.7e+00 2.0e-01 0.720 0.646 0.00
  33 -2.330121171e+08 +2.57830056e+08 2.68e+02 7.9e+00 2.3e-01 0.720 0.646 0.00
  34 -2.330017841e+08 +2.57809390e+08 2.90e+02 8.0e+00 2.7e-01 0.721 0.646 0.00
  35 -2.329905582e+08 +2.57786938e+08 3.15e+02 8.1e+00 3.2e-01 0.721 0.646 0.00
  36 -2.329782125e+08 +2.57762247e+08 3.41e+02 8.2e+00 3.5e-01 0.721 0.646 0.00
  37 -2.329645788e+08 +2.57734979e+08 3.62e+02 8.1e+00 3.8e-01 0.721 0.647 0.00
  38 -2.329495818e+08 +2.57704985e+08 3.77e+02 8.3e+00 3.9e-01 0.720 0.647 0.00
  39 -2.329332998e+08 +2.57672422e+08 3.80e+02 8.3e+00 3.8e-01 0.720 0.647 0.00
  40 -2.329159497e+08 +2.57637721e+08 3.68e+02 7.9e+00 3.1e-01 0.719 0.648 0.00
  41 -2.328980942e+08 +2.57602010e+08 3.41e+02 7.2e+00 2.4e-01 0.719 0.649 0.00
  42 -2.328806212e+08 +2.57567064e+08 3.00e+02 6.2e+00 2.3e-01 0.718 0.650 0.00
  43 -2.328642012e+08 +2.57534224e+08 2.51e+02 5.1e+00 2.0e-01 0.717 0.651 0.00
  44 -2.328494347e+08 +2.57504691e+08 2.10e+02 4.2e+00 2.0e-01 0.717 0.651 0.00
  45 -2.328367271e+08 +2.57479276e+08 1.99e+02 3.6e+00 2.0e-01 0.716 0.652 0.00
  46 -2.328261761e+08 +2.57458174e+08 1.84e+02 3.2e+00 1.7e-01 0.715 0.653 0.00
  47 -2.328176520e+08 +2.57441126e+08 1.66e+02 2.8e+00 1.3e-01 0.714 0.653 0.00
  48 -2.328109048e+08 +2.57427631e+08 1.47e+02 2.4e+00 1.1e-01 0.714 0.654 0.00
  49 -2.328056269e+08 +2.57417076e+08 1.28e+02 2.0e+00 9.5e-02 0.713 0.654 0.00
  50 -2.328015205e+08 +2.57408863e+08 1.11e+02 1.7e+00 8.2e-02 0.712 0.655 0.00
  51 -2.327983338e+08 +2.57402490e+08 9.50e+01 1.4e+00 6.7e-02 0.712 0.655 0.00
  52 -2.327958538e+08 +2.57397529e+08 8.06e+01 1.1e+00 6.1e-02 0.711 0.656 0.00
  53 -2.327939081e+08 +2.57393638e+08 6.87e+01 9.4e-01 5.4e-02 0.711 0.656 0.00
  54 -2.327923735e+08 +2.57390569e+08 5.88e+01 8.5e-01 4.7e-02 0.711 0.656 0.00
  55 -2.327911513e+08 +2.57388124e+08 5.06e+01 7.6e-01 4.2e-02 0.710 0.657 0.00
  56 -2.327901704e+08 +2.57386163e+08 4.37e+01 6.4e-01 3.8e-02 0.710 0.657 0.00
  57 -2.327893856e+08 +2.57384593e+08 3.80e+01 5.6e-01 3.5e-02 0.710 0.658 0.00
  58 -2.327887536e+08 +2.57383329e+08 3.32e+01 4.9e-01 3.2e-02 0.710 0.658 0.00
  59 -2.327882384e+08 +2.57382299e+08 2.92e+01 4.3e-01 2.8e-02 0.709 0.658 0.00
  60 -2.327878196e+08 +2.57381461e+08 2.95e+01 4.0e-01 2.6e-02 0.709 0.658 0.00
  61 -2.327874876e+08 +2.57380797e+08 2.65e+01 3.4e-01 2.3e-02 0.709 0.659 0.00
  62 -2.327872262e+08 +2.57380274e+08 2.30e+01 3.0e-01 2.1e-02 0.709 0.659 0.00
  63 -2.327870223e+08 +2.57379867e+08 1.91e+01 2.5e-01 1.8e-02 0.709 0.659 0.00
  64 -2.327868615e+08 +2.57379545e+08 1.60e+01 2.1e-01 1.6e-02 0.709 0.659 0.00
  65 -2.327867336e+08 +2.57379289e+08 1.36e+01 1.9e-01 1.5e-02 0.709 0.659 0.00
  66 -2.327866310e+08 +2.57379084e+08 1.18e+01 1.8e-01 1.3e-02 0.708 0.659 0.00
  67 -2.327865482e+08 +2.57378918e+08 1.03e+01 1.7e-01 1.2e-02 0.708 0.659 0.00
  68 -2.327864807e+08 +2.57378783e+08 9.07e+00 1.6e-01 1.1e-02 0.708 0.659 0.00
  69 -2.327864253e+08 +2.57378672e+08 8.00e+00 1.5e-01 9.7e-03 0.708 0.659 0.00
  70 -2.327863794e+08 +2.57378581e+08 7.08e+00 1.4e-01 8.8e-03 0.708 0.660 0.00
  71 -2.327863411e+08 +2.57378504e+08 6.28e+00 1.5e-01 8.0e-03 0.708 0.660 0.00
  72 -2.327863090e+08 +2.57378440e+08 5.57e+00 1.5e-01 7.3e-03 0.708 0.660 0.00
  73 -2.327862819e+08 +2.57378386e+08 5.17e+00 1.5e-01 6.7e-03 0.708 0.660 0.00
  74 -2.327862587e+08 +2.57378339e+08 5.16e+00 1.5e-01 6.3e-03 0.708 0.660 0.00
  75 -2.327862387e+08 +2.57378299e+08 5.51e+00 1.6e-01 6.0e-03 0.708 0.660 0.00
  76 -2.327862213e+08 +2.57378265e+08 5.84e+00 1.6e-01 5.7e-03 0.708 0.660 0.00
  77 -2.327862061e+08 +2.57378234e+08 6.14e+00 1.6e-01 5.2e-03 0.708 0.660 0.00
  78 -2.327861925e+08 +2.57378207e+08 6.41e+00 1.6e-01 4.9e-03 0.708 0.660 0.00
  79 -2.327861804e+08 +2.57378183e+08 6.64e+00 1.6e-01 4.6e-03 0.708 0.660 0.00
  80 -2.327861695e+08 +2.57378161e+08 6.84e+00 1.6e-01 4.4e-03 0.708 0.660 0.00
  81 -2.327861595e+08 +2.57378141e+08 7.03e+00 1.6e-01 4.1e-03 0.708 0.660 0.00
  82 -2.327861503e+08 +2.57378122e+08 7.18e+00 1.6e-01 3.9e-03 0.708 0.660 0.00
  83 -2.327861418e+08 +2.57378105e+08 7.31e+00 1.6e-01 3.7e-03 0.708 0.660 0.00
  84 -2.327861339e+08 +2.57378090e+08 7.43e+00 1.6e-01 3.5e-03 0.708 0.660 0.00
  85 -2.327861264e+08 +2.57378075e+08 7.55e+00 1.7e-01 3.3e-03 0.708 0.660 0.00
  86 -2.327861194e+08 +2.57378061e+08 7.64e+00 1.7e-01 3.2e-03 0.708 0.660 0.00
  87 -2.327861127e+08 +2.57378047e+08 7.72e+00 1.7e-01 3.0e-03 0.708 0.660 0.00
  88 -2.327861063e+08 +2.57378034e+08 7.79e+00 1.7e-01 2.9e-03 0.708 0.660 0.00
  89 -2.327861001e+08 +2.57378022e+08 7.84e+00 1.7e-01 2.7e-03 0.708 0.660 0.00
  90 -2.327860942e+08 +2.57378010e+08 7.88e+00 1.7e-01 2.6e-03 0.708 0.660 0.00
  91 -2.327860885e+08 +2.57377999e+08 7.91e+00 1.7e-01 2.5e-03 0.708 0.660 0.00
  92 -2.327860829e+08 +2.57377988e+08 7.92e+00 1.7e-01 2.3e-03 0.708 0.660 0.00
  93 -2.327860775e+08 +2.57377977e+08 7.93e+00 1.7e-01 2.3e-03 0.708 0.660 0.00
  94 -2.327860722e+08 +2.57377966e+08 7.94e+00 1.7e-01 2.3e-03 0.708 0.660 0.00
  95 -2.327860671e+08 +2.57377956e+08 7.94e+00 1.7e-01 2.3e-03 0.708 0.660 0.00
  96 -2.327860620e+08 +2.57377946e+08 7.94e+00 1.6e-01 2.3e-03 0.708 0.660 0.00
  97 -2.327860570e+08 +2.57377936e+08 7.94e+00 1.6e-01 2.3e-03 0.708 0.660 0.00
  98 -2.327860522e+08 +2.57377926e+08 7.94e+00 1.6e-01 2.3e-03 0.708 0.660 0.00
  99 -2.327860474e+08 +2.57377917e+08 7.93e+00 1.6e-01 2.3e-03 0.708 0.660 0.00
 100 -2.327860426e+08 +2.57377907e+08 7.92e+00 1.6e-01 2.3e-03 0.708 0.660 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
26710.466  1618.892 12137.872 
