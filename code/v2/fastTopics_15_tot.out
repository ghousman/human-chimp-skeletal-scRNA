
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 15"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-15 Poisson NMF to 101534 x 18454 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.082993093e+09 +1.17898429e+09 1.12e+05 2.0e+02 1.4e+00 0.680 0.521 0.00
   2 -1.056259870e+09 +1.12551785e+09 3.68e+04 6.3e+01 2.8e+00 0.642 0.665 0.00
   3 -1.048044940e+09 +1.10908799e+09 2.95e+04 6.6e+01 2.0e+00 0.650 0.624 0.00
   4 -1.044120989e+09 +1.10124009e+09 3.37e+04 5.0e+01 1.1e+00 0.654 0.627 0.00
   5 -1.041882390e+09 +1.09676289e+09 3.19e+04 4.0e+01 1.3e+00 0.658 0.625 0.00
   6 -1.040496383e+09 +1.09399087e+09 2.46e+04 3.2e+01 1.1e+00 0.660 0.619 0.00
   7 -1.039535956e+09 +1.09207002e+09 1.83e+04 2.6e+01 7.6e-01 0.663 0.612 0.00
   8 -1.038815795e+09 +1.09062970e+09 1.38e+04 2.2e+01 6.8e-01 0.665 0.605 0.00
   9 -1.038263733e+09 +1.08952557e+09 1.05e+04 1.9e+01 7.1e-01 0.666 0.600 0.00
  10 -1.037836526e+09 +1.08867116e+09 8.21e+03 1.7e+01 7.8e-01 0.667 0.596 0.00
  11 -1.037495496e+09 +1.08798910e+09 6.43e+03 1.5e+01 7.6e-01 0.668 0.592 0.00
  12 -1.037204684e+09 +1.08740747e+09 5.64e+03 1.4e+01 6.7e-01 0.669 0.590 0.00
  13 -1.036942387e+09 +1.08688288e+09 5.61e+03 1.5e+01 6.0e-01 0.670 0.589 0.00
  14 -1.036700425e+09 +1.08639896e+09 5.61e+03 1.7e+01 5.4e-01 0.671 0.587 0.00
  15 -1.036473822e+09 +1.08594575e+09 5.35e+03 1.9e+01 5.0e-01 0.672 0.586 0.00
  16 -1.036253884e+09 +1.08550588e+09 5.12e+03 2.2e+01 4.7e-01 0.673 0.584 0.00
  17 -1.036032061e+09 +1.08506223e+09 7.54e+03 2.3e+01 4.3e-01 0.674 0.583 0.00
  18 -1.035805284e+09 +1.08460868e+09 9.70e+03 2.3e+01 5.5e-01 0.675 0.582 0.00
  19 -1.035580035e+09 +1.08415818e+09 1.13e+04 2.1e+01 7.5e-01 0.675 0.581 0.00
  20 -1.035368473e+09 +1.08373505e+09 1.24e+04 1.8e+01 7.0e-01 0.676 0.581 0.00
  21 -1.035175926e+09 +1.08334996e+09 1.36e+04 1.5e+01 4.8e-01 0.677 0.580 0.00
  22 -1.034996932e+09 +1.08299197e+09 1.37e+04 1.3e+01 3.3e-01 0.678 0.579 0.00
  23 -1.034822592e+09 +1.08264329e+09 1.32e+04 1.1e+01 2.9e-01 0.678 0.578 0.00
  24 -1.034642732e+09 +1.08228357e+09 1.25e+04 1.0e+01 2.8e-01 0.678 0.578 0.00
  25 -1.034451953e+09 +1.08190201e+09 1.14e+04 9.6e+00 2.7e-01 0.679 0.578 0.00
  26 -1.034249112e+09 +1.08149633e+09 3.65e+03 9.0e+00 3.2e-01 0.680 0.578 0.00
  27 -1.034042640e+09 +1.08108339e+09 3.53e+03 8.6e+00 3.9e-01 0.680 0.579 0.00
  28 -1.033861921e+09 +1.08072195e+09 3.88e+03 8.3e+00 5.5e-01 0.681 0.579 0.00
  29 -1.033732868e+09 +1.08046384e+09 4.09e+03 7.7e+00 4.7e-01 0.681 0.578 0.00
  30 -1.033643370e+09 +1.08028485e+09 3.81e+03 7.1e+00 2.7e-01 0.681 0.577 0.00
  31 -1.033575837e+09 +1.08014978e+09 3.40e+03 6.5e+00 2.1e-01 0.682 0.575 0.00
  32 -1.033521617e+09 +1.08004134e+09 2.28e+03 5.9e+00 2.0e-01 0.682 0.574 0.00
  33 -1.033475973e+09 +1.07995005e+09 2.11e+03 5.3e+00 2.0e-01 0.682 0.573 0.00
  34 -1.033436442e+09 +1.07987099e+09 1.90e+03 4.8e+00 2.0e-01 0.682 0.572 0.00
  35 -1.033401462e+09 +1.07980103e+09 1.59e+03 4.3e+00 2.0e-01 0.683 0.572 0.00
  36 -1.033369760e+09 +1.07973763e+09 1.35e+03 3.8e+00 2.0e-01 0.683 0.571 0.00
  37 -1.033340105e+09 +1.07967832e+09 1.30e+03 3.3e+00 2.0e-01 0.683 0.570 0.00
  38 -1.033311311e+09 +1.07962073e+09 1.27e+03 2.9e+00 2.0e-01 0.683 0.570 0.00
  39 -1.033282546e+09 +1.07956320e+09 1.23e+03 2.5e+00 2.0e-01 0.684 0.569 0.00
  40 -1.033253633e+09 +1.07950537e+09 1.19e+03 2.2e+00 2.1e-01 0.684 0.569 0.00
  41 -1.033225512e+09 +1.07944913e+09 1.13e+03 2.0e+00 2.1e-01 0.684 0.569 0.00
  42 -1.033199238e+09 +1.07939658e+09 1.06e+03 1.9e+00 2.1e-01 0.684 0.568 0.00
  43 -1.033174844e+09 +1.07934779e+09 9.88e+02 1.9e+00 2.1e-01 0.684 0.568 0.00
  44 -1.033151791e+09 +1.07930169e+09 1.01e+03 1.9e+00 2.1e-01 0.685 0.567 0.00
  45 -1.033129453e+09 +1.07925701e+09 1.04e+03 1.9e+00 2.1e-01 0.685 0.567 0.00
  46 -1.033107283e+09 +1.07921267e+09 1.07e+03 1.9e+00 2.1e-01 0.685 0.567 0.00
  47 -1.033084849e+09 +1.07916781e+09 1.08e+03 2.0e+00 2.1e-01 0.685 0.567 0.00
  48 -1.033061834e+09 +1.07912177e+09 1.08e+03 2.1e+00 2.1e-01 0.685 0.567 0.00
  49 -1.033037937e+09 +1.07907398e+09 1.05e+03 2.2e+00 2.2e-01 0.685 0.567 0.00
  50 -1.033012840e+09 +1.07902379e+09 9.97e+02 2.3e+00 2.4e-01 0.685 0.566 0.00
  51 -1.032986174e+09 +1.07897045e+09 9.22e+02 2.4e+00 2.9e-01 0.685 0.566 0.00
  52 -1.032957766e+09 +1.07891364e+09 8.27e+02 2.5e+00 3.3e-01 0.685 0.566 0.00
  53 -1.032927359e+09 +1.07885283e+09 7.57e+02 2.6e+00 3.8e-01 0.685 0.566 0.00
  54 -1.032894248e+09 +1.07878660e+09 7.89e+02 2.5e+00 4.6e-01 0.685 0.566 0.00
  55 -1.032858088e+09 +1.07871428e+09 8.12e+02 2.6e+00 5.0e-01 0.685 0.566 0.00
  56 -1.032822192e+09 +1.07864249e+09 8.09e+02 2.6e+00 5.8e-01 0.686 0.566 0.00
  57 -1.032789822e+09 +1.07857775e+09 7.71e+02 2.7e+00 4.2e-01 0.686 0.566 0.00
  58 -1.032760921e+09 +1.07851995e+09 7.14e+02 2.6e+00 3.2e-01 0.686 0.566 0.00
  59 -1.032735220e+09 +1.07846855e+09 7.25e+02 2.6e+00 2.7e-01 0.686 0.567 0.00
  60 -1.032712495e+09 +1.07842310e+09 7.24e+02 2.5e+00 2.3e-01 0.685 0.567 0.00
  61 -1.032692750e+09 +1.07838361e+09 7.15e+02 2.4e+00 2.0e-01 0.685 0.567 0.00
  62 -1.032676013e+09 +1.07835013e+09 6.98e+02 2.3e+00 1.8e-01 0.686 0.567 0.00
  63 -1.032661971e+09 +1.07832205e+09 6.76e+02 2.2e+00 1.7e-01 0.686 0.567 0.00
  64 -1.032650270e+09 +1.07829865e+09 6.47e+02 2.0e+00 1.5e-01 0.686 0.568 0.00
  65 -1.032640526e+09 +1.07827916e+09 6.09e+02 1.9e+00 1.4e-01 0.686 0.568 0.00
  66 -1.032632385e+09 +1.07826288e+09 5.65e+02 1.8e+00 1.3e-01 0.686 0.568 0.00
  67 -1.032625538e+09 +1.07824918e+09 5.19e+02 1.6e+00 1.1e-01 0.686 0.568 0.00
  68 -1.032619712e+09 +1.07823753e+09 4.74e+02 1.5e+00 1.0e-01 0.686 0.568 0.00
  69 -1.032614690e+09 +1.07822749e+09 4.31e+02 1.4e+00 9.1e-02 0.685 0.569 0.00
  70 -1.032610300e+09 +1.07821871e+09 3.91e+02 1.3e+00 8.1e-02 0.685 0.569 0.00
  71 -1.032606411e+09 +1.07821093e+09 3.54e+02 1.1e+00 7.0e-02 0.685 0.569 0.00
  72 -1.032602907e+09 +1.07820392e+09 3.18e+02 1.0e+00 6.1e-02 0.685 0.569 0.00
  73 -1.032599705e+09 +1.07819752e+09 2.84e+02 9.5e-01 5.9e-02 0.685 0.569 0.00
  74 -1.032596746e+09 +1.07819160e+09 2.53e+02 8.6e-01 5.8e-02 0.685 0.569 0.00
  75 -1.032593985e+09 +1.07818608e+09 2.44e+02 7.8e-01 5.8e-02 0.685 0.569 0.00
  76 -1.032591386e+09 +1.07818088e+09 2.38e+02 7.1e-01 5.7e-02 0.685 0.569 0.00
  77 -1.032588920e+09 +1.07817595e+09 2.32e+02 6.9e-01 5.7e-02 0.685 0.570 0.00
  78 -1.032586564e+09 +1.07817124e+09 2.30e+02 6.9e-01 5.7e-02 0.685 0.570 0.00
  79 -1.032584302e+09 +1.07816671e+09 2.29e+02 7.0e-01 5.7e-02 0.685 0.570 0.00
  80 -1.032582117e+09 +1.07816234e+09 2.28e+02 7.0e-01 5.7e-02 0.685 0.570 0.00
  81 -1.032579995e+09 +1.07815810e+09 2.26e+02 7.0e-01 5.8e-02 0.685 0.570 0.00
  82 -1.032577924e+09 +1.07815396e+09 2.24e+02 7.1e-01 5.8e-02 0.685 0.570 0.00
  83 -1.032575894e+09 +1.07814990e+09 2.23e+02 7.2e-01 5.9e-02 0.685 0.570 0.00
  84 -1.032573895e+09 +1.07814590e+09 2.21e+02 7.3e-01 5.9e-02 0.685 0.570 0.00
  85 -1.032571917e+09 +1.07814194e+09 2.19e+02 7.4e-01 6.0e-02 0.685 0.570 0.00
  86 -1.032569952e+09 +1.07813801e+09 2.17e+02 7.5e-01 6.1e-02 0.685 0.570 0.00
  87 -1.032567993e+09 +1.07813409e+09 2.15e+02 7.6e-01 6.2e-02 0.685 0.570 0.00
  88 -1.032566031e+09 +1.07813017e+09 2.13e+02 7.8e-01 6.3e-02 0.685 0.570 0.00
  89 -1.032564047e+09 +1.07812620e+09 2.11e+02 7.9e-01 6.4e-02 0.685 0.570 0.00
  90 -1.032562024e+09 +1.07812216e+09 2.09e+02 8.2e-01 6.5e-02 0.685 0.571 0.00
  91 -1.032559948e+09 +1.07811800e+09 2.07e+02 8.4e-01 6.6e-02 0.685 0.571 0.00
  92 -1.032557807e+09 +1.07811372e+09 2.05e+02 8.7e-01 6.8e-02 0.685 0.571 0.00
  93 -1.032555587e+09 +1.07810928e+09 2.04e+02 9.1e-01 7.0e-02 0.685 0.571 0.00
  94 -1.032553273e+09 +1.07810465e+09 2.03e+02 9.4e-01 7.3e-02 0.685 0.571 0.00
  95 -1.032550849e+09 +1.07809981e+09 2.03e+02 9.8e-01 7.6e-02 0.685 0.571 0.00
  96 -1.032548294e+09 +1.07809470e+09 2.02e+02 1.0e+00 7.9e-02 0.685 0.571 0.00
  97 -1.032545587e+09 +1.07808928e+09 2.02e+02 1.1e+00 8.2e-02 0.685 0.571 0.00
  98 -1.032542707e+09 +1.07808352e+09 2.04e+02 1.1e+00 8.6e-02 0.685 0.571 0.00
  99 -1.032539636e+09 +1.07807738e+09 2.08e+02 1.2e+00 8.9e-02 0.685 0.571 0.00
 100 -1.032536350e+09 +1.07807081e+09 2.12e+02 1.2e+00 9.3e-02 0.685 0.571 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
214771.71  10722.88  79108.90 
