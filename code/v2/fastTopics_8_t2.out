
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 8"
> print(paste0("data source: ",data.source))
[1] "data source: t2"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-8 Poisson NMF to 27151 x 17304 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -2.477662358e+08 +2.87338294e+08 9.13e+03 3.7e+02 1.8e+00 0.698 0.642 0.00
   2 -2.429516650e+08 +2.77709152e+08 9.53e+03 8.8e+01 2.5e+00 0.706 0.723 0.00
   3 -2.409072104e+08 +2.73620243e+08 5.66e+03 4.9e+01 1.9e+00 0.702 0.693 0.00
   4 -2.398147658e+08 +2.71435353e+08 2.44e+03 3.6e+01 1.5e+00 0.698 0.702 0.00
   5 -2.390727458e+08 +2.69951314e+08 2.43e+03 3.3e+01 1.2e+00 0.697 0.712 0.00
   6 -2.385005500e+08 +2.68806922e+08 1.79e+03 3.5e+01 9.5e-01 0.699 0.719 0.00
   7 -2.380728413e+08 +2.67951504e+08 1.60e+03 2.9e+01 6.8e-01 0.702 0.723 0.00
   8 -2.377650175e+08 +2.67335857e+08 1.28e+03 2.2e+01 5.1e-01 0.705 0.725 0.00
   9 -2.375358535e+08 +2.66877529e+08 1.11e+03 1.7e+01 4.8e-01 0.708 0.725 0.00
  10 -2.373633168e+08 +2.66532455e+08 8.42e+02 1.4e+01 5.9e-01 0.711 0.724 0.00
  11 -2.372343517e+08 +2.66274525e+08 9.18e+02 1.2e+01 6.8e-01 0.714 0.721 0.00
  12 -2.371298353e+08 +2.66065492e+08 3.61e+02 1.0e+01 6.1e-01 0.716 0.716 0.00
  13 -2.370505618e+08 +2.65906946e+08 3.00e+02 7.2e+00 6.6e-01 0.718 0.712 0.00
  14 -2.370039570e+08 +2.65813736e+08 3.06e+02 4.5e+00 7.2e-01 0.719 0.708 0.00
  15 -2.369815905e+08 +2.65769003e+08 2.50e+02 2.5e+00 8.2e-01 0.719 0.705 0.00
  16 -2.369708314e+08 +2.65747485e+08 2.57e+02 2.7e+00 2.0e-01 0.719 0.702 0.00
  17 -2.369641207e+08 +2.65734063e+08 2.55e+02 2.8e+00 1.2e-01 0.719 0.699 0.00
  18 -2.369590334e+08 +2.65723889e+08 2.45e+02 2.8e+00 5.8e-02 0.720 0.697 0.00
  19 -2.369547469e+08 +2.65715316e+08 2.32e+02 2.8e+00 5.3e-02 0.719 0.696 0.00
  20 -2.369509474e+08 +2.65707717e+08 2.18e+02 2.8e+00 5.0e-02 0.720 0.696 0.00
  21 -2.369474951e+08 +2.65700812e+08 2.05e+02 2.8e+00 4.7e-02 0.720 0.695 0.00
  22 -2.369443225e+08 +2.65694467e+08 1.91e+02 2.7e+00 4.4e-02 0.720 0.695 0.00
  23 -2.369413843e+08 +2.65688591e+08 1.78e+02 2.7e+00 4.2e-02 0.720 0.695 0.00
  24 -2.369386453e+08 +2.65683112e+08 5.76e+01 2.6e+00 3.9e-02 0.720 0.695 0.00
  25 -2.369360890e+08 +2.65678000e+08 1.00e+02 2.6e+00 3.6e-02 0.720 0.694 0.00
  26 -2.369336984e+08 +2.65673219e+08 9.48e+01 2.7e+00 3.4e-02 0.720 0.694 0.00
  27 -2.369314575e+08 +2.65668737e+08 9.00e+01 2.8e+00 3.2e-02 0.720 0.694 0.00
  28 -2.369293502e+08 +2.65664522e+08 8.64e+01 3.0e+00 3.1e-02 0.721 0.694 0.00
  29 -2.369273579e+08 +2.65660538e+08 8.38e+01 3.2e+00 3.0e-02 0.721 0.693 0.00
  30 -2.369254662e+08 +2.65656754e+08 8.16e+01 3.4e+00 3.1e-02 0.721 0.693 0.00
  31 -2.369236641e+08 +2.65653150e+08 7.99e+01 3.6e+00 3.2e-02 0.721 0.693 0.00
  32 -2.369219370e+08 +2.65649696e+08 7.92e+01 3.8e+00 3.3e-02 0.721 0.693 0.00
  33 -2.369202672e+08 +2.65646356e+08 7.91e+01 4.0e+00 3.4e-02 0.722 0.693 0.00
  34 -2.369186364e+08 +2.65643095e+08 7.95e+01 4.3e+00 3.5e-02 0.722 0.692 0.00
  35 -2.369170256e+08 +2.65639873e+08 8.05e+01 4.6e+00 3.6e-02 0.722 0.692 0.00
  36 -2.369154138e+08 +2.65636650e+08 8.18e+01 5.0e+00 3.9e-02 0.722 0.691 0.00
  37 -2.369137801e+08 +2.65633382e+08 8.34e+01 5.4e+00 4.3e-02 0.722 0.691 0.00
  38 -2.369120997e+08 +2.65630021e+08 8.55e+01 5.9e+00 4.8e-02 0.723 0.691 0.00
  39 -2.369103387e+08 +2.65626499e+08 8.75e+01 6.5e+00 5.2e-02 0.723 0.690 0.00
  40 -2.369084576e+08 +2.65622737e+08 8.95e+01 7.1e+00 5.8e-02 0.723 0.690 0.00
  41 -2.369064167e+08 +2.65618655e+08 9.12e+01 7.8e+00 6.4e-02 0.723 0.690 0.00
  42 -2.369041677e+08 +2.65614157e+08 9.27e+01 8.6e+00 7.1e-02 0.724 0.689 0.00
  43 -2.369016481e+08 +2.65609118e+08 9.38e+01 9.5e+00 7.8e-02 0.724 0.689 0.00
  44 -2.368987922e+08 +2.65603406e+08 1.20e+02 1.1e+01 8.6e-02 0.725 0.688 0.00
  45 -2.368955200e+08 +2.65596862e+08 1.20e+02 1.2e+01 9.5e-02 0.725 0.688 0.00
  46 -2.368917386e+08 +2.65589299e+08 1.07e+02 1.3e+01 1.0e-01 0.726 0.687 0.00
  47 -2.368873248e+08 +2.65580471e+08 1.07e+02 1.5e+01 1.1e-01 0.726 0.686 0.00
  48 -2.368821311e+08 +2.65570084e+08 1.06e+02 1.6e+01 1.3e-01 0.727 0.686 0.00
  49 -2.368759564e+08 +2.65557735e+08 1.03e+02 1.8e+01 1.4e-01 0.728 0.685 0.00
  50 -2.368685032e+08 +2.65542828e+08 1.07e+02 2.0e+01 1.6e-01 0.728 0.684 0.00
  51 -2.368594431e+08 +2.65524708e+08 1.17e+02 2.3e+01 1.7e-01 0.729 0.683 0.00
  52 -2.368484557e+08 +2.65502733e+08 1.35e+02 2.5e+01 1.9e-01 0.731 0.682 0.00
  53 -2.368348897e+08 +2.65475601e+08 1.57e+02 2.8e+01 2.0e-01 0.731 0.681 0.00
  54 -2.368183745e+08 +2.65442571e+08 1.86e+02 3.2e+01 2.2e-01 0.733 0.680 0.00
  55 -2.367980960e+08 +2.65402014e+08 2.22e+02 3.5e+01 2.3e-01 0.734 0.679 0.00
  56 -2.367731638e+08 +2.65352150e+08 2.62e+02 3.8e+01 2.4e-01 0.736 0.677 0.00
  57 -2.367428624e+08 +2.65291547e+08 3.07e+02 4.1e+01 2.4e-01 0.737 0.676 0.00
  58 -2.367074386e+08 +2.65220699e+08 3.56e+02 4.3e+01 2.7e-01 0.739 0.675 0.00
  59 -2.366688109e+08 +2.65143444e+08 3.88e+02 4.2e+01 3.4e-01 0.741 0.675 0.00
  60 -2.366299950e+08 +2.65065812e+08 3.83e+02 3.8e+01 3.8e-01 0.743 0.675 0.00
  61 -2.365941877e+08 +2.64994197e+08 3.58e+02 3.3e+01 4.4e-01 0.745 0.674 0.00
  62 -2.365628609e+08 +2.64931544e+08 3.90e+02 2.7e+01 4.5e-01 0.747 0.674 0.00
  63 -2.365364171e+08 +2.64878656e+08 4.09e+02 2.2e+01 4.0e-01 0.749 0.674 0.00
  64 -2.365148189e+08 +2.64835460e+08 4.03e+02 1.7e+01 3.3e-01 0.750 0.675 0.00
  65 -2.364975596e+08 +2.64800941e+08 3.79e+02 1.3e+01 2.4e-01 0.751 0.675 0.00
  66 -2.364838314e+08 +2.64773485e+08 3.42e+02 9.5e+00 1.6e-01 0.752 0.676 0.00
  67 -2.364728119e+08 +2.64751446e+08 2.99e+02 7.1e+00 1.3e-01 0.753 0.677 0.00
  68 -2.364638157e+08 +2.64733453e+08 2.59e+02 5.4e+00 9.8e-02 0.753 0.677 0.00
  69 -2.364563461e+08 +2.64718514e+08 2.25e+02 4.2e+00 7.6e-02 0.754 0.677 0.00
  70 -2.364500605e+08 +2.64705943e+08 1.97e+02 3.7e+00 6.0e-02 0.754 0.678 0.00
  71 -2.364447293e+08 +2.64695281e+08 1.24e+02 3.3e+00 5.0e-02 0.754 0.678 0.00
  72 -2.364401954e+08 +2.64686213e+08 1.14e+02 3.0e+00 4.8e-02 0.754 0.679 0.00
  73 -2.364364024e+08 +2.64678627e+08 1.02e+02 2.9e+00 4.7e-02 0.755 0.679 0.00
  74 -2.364332839e+08 +2.64672390e+08 9.19e+01 2.7e+00 4.5e-02 0.755 0.680 0.00
  75 -2.364306774e+08 +2.64667177e+08 8.33e+01 2.4e+00 4.3e-02 0.755 0.680 0.00
  76 -2.364284892e+08 +2.64662800e+08 7.58e+01 2.2e+00 4.1e-02 0.755 0.681 0.00
  77 -2.364266436e+08 +2.64659109e+08 6.94e+01 2.0e+00 4.0e-02 0.755 0.681 0.00
  78 -2.364250833e+08 +2.64655989e+08 6.37e+01 1.8e+00 3.9e-02 0.755 0.681 0.00
  79 -2.364237634e+08 +2.64653349e+08 5.85e+01 1.6e+00 3.8e-02 0.755 0.682 0.00
  80 -2.364226433e+08 +2.64651108e+08 5.40e+01 1.5e+00 3.7e-02 0.755 0.682 0.00
  81 -2.364216921e+08 +2.64649206e+08 4.98e+01 1.3e+00 3.5e-02 0.755 0.682 0.00
  82 -2.364208793e+08 +2.64647581e+08 4.61e+01 1.2e+00 3.4e-02 0.755 0.682 0.00
  83 -2.364201813e+08 +2.64646184e+08 4.30e+01 1.1e+00 3.2e-02 0.754 0.683 0.00
  84 -2.364195799e+08 +2.64644982e+08 4.01e+01 1.0e+00 3.0e-02 0.754 0.683 0.00
  85 -2.364190590e+08 +2.64643940e+08 3.75e+01 9.6e-01 2.9e-02 0.754 0.683 0.00
  86 -2.364186052e+08 +2.64643032e+08 3.51e+01 8.9e-01 2.8e-02 0.754 0.683 0.00
  87 -2.364182071e+08 +2.64642236e+08 3.30e+01 8.2e-01 2.7e-02 0.754 0.683 0.00
  88 -2.364178561e+08 +2.64641534e+08 3.11e+01 7.7e-01 2.6e-02 0.754 0.683 0.00
  89 -2.364175445e+08 +2.64640911e+08 2.94e+01 7.2e-01 2.5e-02 0.754 0.684 0.00
  90 -2.364172666e+08 +2.64640355e+08 2.78e+01 6.7e-01 2.3e-02 0.754 0.684 0.00
  91 -2.364170173e+08 +2.64639856e+08 2.63e+01 6.3e-01 2.2e-02 0.754 0.684 0.00
  92 -2.364167925e+08 +2.64639407e+08 2.50e+01 6.0e-01 2.1e-02 0.754 0.684 0.00
  93 -2.364165888e+08 +2.64638999e+08 2.38e+01 5.6e-01 2.0e-02 0.754 0.684 0.00
  94 -2.364164035e+08 +2.64638629e+08 2.27e+01 5.3e-01 1.9e-02 0.754 0.684 0.00
  95 -2.364162345e+08 +2.64638291e+08 2.17e+01 5.1e-01 1.8e-02 0.754 0.684 0.00
  96 -2.364160795e+08 +2.64637981e+08 2.07e+01 4.8e-01 1.7e-02 0.754 0.684 0.00
  97 -2.364159369e+08 +2.64637696e+08 1.99e+01 4.6e-01 1.7e-02 0.754 0.684 0.00
  98 -2.364158054e+08 +2.64637433e+08 1.91e+01 4.4e-01 1.6e-02 0.754 0.684 0.00
  99 -2.364156839e+08 +2.64637190e+08 1.83e+01 4.2e-01 1.5e-02 0.754 0.684 0.00
 100 -2.364155711e+08 +2.64636964e+08 1.76e+01 4.0e-01 1.5e-02 0.754 0.684 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
22411.622  1567.423 10956.278 
