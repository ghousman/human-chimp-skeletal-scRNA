
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 50"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filter.log.indv-cell.int19k.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-50 Poisson NMF to 101534 x 18454 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.058624036e+09 +1.13024618e+09 3.71e+04 1.2e+02 2.9e+01 0.542 0.170 0.00
   2 -1.005125591e+09 +1.02324929e+09 4.88e+04 1.3e+02 2.6e+01 0.530 0.288 0.00
   3 -9.914162424e+08 +9.95830592e+08 2.43e+04 1.2e+02 6.3e+00 0.529 0.337 0.00
   4 -9.850887466e+08 +9.83175601e+08 1.21e+04 1.1e+02 4.8e+00 0.529 0.368 0.00
   5 -9.817345835e+08 +9.76467275e+08 8.87e+03 9.8e+01 3.1e+00 0.530 0.389 0.00
   6 -9.797123279e+08 +9.72422763e+08 6.67e+03 7.5e+01 1.9e+00 0.531 0.403 0.00
   7 -9.783953055e+08 +9.69788719e+08 7.13e+03 5.6e+01 1.8e+00 0.532 0.412 0.00
   8 -9.775203721e+08 +9.68038852e+08 7.52e+03 4.2e+01 2.0e+00 0.533 0.419 0.00
   9 -9.768877767e+08 +9.66773661e+08 7.30e+03 3.2e+01 1.9e+00 0.534 0.423 0.00
  10 -9.764008243e+08 +9.65799756e+08 6.61e+03 2.5e+01 1.9e+00 0.535 0.426 0.00
  11 -9.760266181e+08 +9.65051344e+08 5.93e+03 2.1e+01 1.6e+00 0.536 0.428 0.00
  12 -9.757249716e+08 +9.64448051e+08 5.30e+03 2.2e+01 1.3e+00 0.537 0.430 0.00
  13 -9.754692339e+08 +9.63936575e+08 4.79e+03 2.3e+01 1.1e+00 0.538 0.432 0.00
  14 -9.752487338e+08 +9.63495575e+08 4.85e+03 2.3e+01 9.9e-01 0.539 0.433 0.00
  15 -9.750572843e+08 +9.63112676e+08 5.08e+03 2.4e+01 9.8e-01 0.540 0.434 0.00
  16 -9.748888559e+08 +9.62775819e+08 5.21e+03 2.4e+01 1.0e+00 0.541 0.435 0.00
  17 -9.747341458e+08 +9.62466399e+08 5.56e+03 2.3e+01 1.2e+00 0.542 0.435 0.00
  18 -9.745857396e+08 +9.62169587e+08 5.97e+03 2.3e+01 1.4e+00 0.543 0.436 0.00
  19 -9.744496890e+08 +9.61897486e+08 6.37e+03 2.3e+01 1.4e+00 0.544 0.435 0.00
  20 -9.743417225e+08 +9.61681553e+08 6.62e+03 2.2e+01 1.0e+00 0.544 0.435 0.00
  21 -9.742543326e+08 +9.61506773e+08 6.61e+03 2.1e+01 8.4e-01 0.545 0.435 0.00
  22 -9.741817146e+08 +9.61361537e+08 6.28e+03 2.0e+01 7.3e-01 0.546 0.434 0.00
  23 -9.741213904e+08 +9.61240888e+08 5.19e+03 1.8e+01 6.2e-01 0.547 0.434 0.00
  24 -9.740709734e+08 +9.61140054e+08 3.14e+03 1.7e+01 4.6e-01 0.548 0.434 0.00
  25 -9.740278281e+08 +9.61053764e+08 2.18e+03 1.5e+01 3.4e-01 0.549 0.433 0.00
  26 -9.739900007e+08 +9.60978109e+08 2.09e+03 1.4e+01 2.8e-01 0.549 0.432 0.00
  27 -9.739558817e+08 +9.60909871e+08 2.05e+03 1.3e+01 2.5e-01 0.550 0.432 0.00
  28 -9.739246883e+08 +9.60847484e+08 2.01e+03 1.1e+01 2.3e-01 0.551 0.431 0.00
  29 -9.738958188e+08 +9.60789745e+08 1.97e+03 9.6e+00 2.2e-01 0.551 0.431 0.00
  30 -9.738687697e+08 +9.60735647e+08 1.94e+03 8.5e+00 2.0e-01 0.552 0.430 0.00
  31 -9.738432187e+08 +9.60684545e+08 1.86e+03 7.5e+00 2.0e-01 0.552 0.430 0.00
  32 -9.738187389e+08 +9.60635585e+08 1.82e+03 6.5e+00 1.9e-01 0.553 0.429 0.00
  33 -9.737948907e+08 +9.60587889e+08 1.77e+03 5.7e+00 1.8e-01 0.553 0.428 0.00
  34 -9.737713229e+08 +9.60540753e+08 1.70e+03 5.0e+00 1.7e-01 0.554 0.428 0.00
  35 -9.737477281e+08 +9.60493564e+08 1.62e+03 4.5e+00 1.7e-01 0.554 0.427 0.00
  36 -9.737236878e+08 +9.60445483e+08 1.54e+03 4.0e+00 1.6e-01 0.555 0.427 0.00
  37 -9.736986837e+08 +9.60395475e+08 1.45e+03 3.5e+00 2.0e-01 0.555 0.427 0.00
  38 -9.736722635e+08 +9.60342635e+08 1.33e+03 3.2e+00 2.6e-01 0.556 0.426 0.00
  39 -9.736441733e+08 +9.60286454e+08 1.28e+03 3.9e+00 3.3e-01 0.556 0.426 0.00
  40 -9.736143563e+08 +9.60226820e+08 1.26e+03 4.7e+00 4.1e-01 0.557 0.425 0.00
  41 -9.735830530e+08 +9.60164214e+08 1.23e+03 5.3e+00 4.5e-01 0.557 0.425 0.00
  42 -9.735507087e+08 +9.60099525e+08 1.19e+03 5.7e+00 3.8e-01 0.558 0.424 0.00
  43 -9.735180401e+08 +9.60034188e+08 1.19e+03 5.9e+00 3.4e-01 0.558 0.424 0.00
  44 -9.734855180e+08 +9.59969144e+08 1.22e+03 5.9e+00 3.0e-01 0.559 0.423 0.00
  45 -9.734533911e+08 +9.59904890e+08 1.25e+03 6.4e+00 2.9e-01 0.560 0.422 0.00
  46 -9.734216826e+08 +9.59841473e+08 1.27e+03 6.7e+00 2.9e-01 0.560 0.422 0.00
  47 -9.733902771e+08 +9.59778662e+08 1.31e+03 6.7e+00 2.7e-01 0.561 0.421 0.00
  48 -9.733589354e+08 +9.59715978e+08 1.40e+03 6.5e+00 2.4e-01 0.561 0.421 0.00
  49 -9.733276288e+08 +9.59653365e+08 1.48e+03 6.1e+00 2.5e-01 0.562 0.420 0.00
  50 -9.732968227e+08 +9.59591753e+08 1.56e+03 5.4e+00 2.6e-01 0.562 0.419 0.00
  51 -9.732672031e+08 +9.59532514e+08 1.61e+03 5.0e+00 2.7e-01 0.563 0.419 0.00
  52 -9.732393474e+08 +9.59476802e+08 1.66e+03 4.6e+00 2.6e-01 0.564 0.418 0.00
  53 -9.732134055e+08 +9.59424919e+08 1.68e+03 3.9e+00 2.3e-01 0.564 0.418 0.00
  54 -9.731890456e+08 +9.59376199e+08 1.70e+03 3.2e+00 2.2e-01 0.564 0.418 0.00
  55 -9.731656983e+08 +9.59329504e+08 1.69e+03 2.5e+00 2.0e-01 0.565 0.417 0.00
  56 -9.731426157e+08 +9.59283339e+08 1.68e+03 2.2e+00 1.9e-01 0.565 0.417 0.00
  57 -9.731191514e+08 +9.59236410e+08 1.66e+03 2.2e+00 1.8e-01 0.566 0.416 0.00
  58 -9.730946240e+08 +9.59187356e+08 1.63e+03 2.2e+00 2.0e-01 0.566 0.416 0.00
  59 -9.730691429e+08 +9.59136393e+08 1.60e+03 2.1e+00 2.3e-01 0.567 0.416 0.00
  60 -9.730441078e+08 +9.59086323e+08 1.55e+03 2.0e+00 2.4e-01 0.567 0.415 0.00
  61 -9.730205541e+08 +9.59039216e+08 1.51e+03 2.0e+00 2.4e-01 0.567 0.415 0.00
  62 -9.729991199e+08 +9.58996347e+08 1.51e+03 2.0e+00 2.3e-01 0.568 0.415 0.00
  63 -9.729796517e+08 +9.58957411e+08 1.50e+03 1.9e+00 2.1e-01 0.568 0.415 0.00
  64 -9.729619012e+08 +9.58921910e+08 1.50e+03 1.9e+00 2.0e-01 0.568 0.415 0.00
  65 -9.729455789e+08 +9.58889265e+08 1.49e+03 1.9e+00 1.9e-01 0.568 0.415 0.00
  66 -9.729304741e+08 +9.58859056e+08 1.48e+03 1.9e+00 1.8e-01 0.568 0.415 0.00
  67 -9.729163961e+08 +9.58830900e+08 1.47e+03 1.8e+00 1.8e-01 0.568 0.415 0.00
  68 -9.729032416e+08 +9.58804591e+08 1.44e+03 1.8e+00 1.8e-01 0.569 0.415 0.00
  69 -9.728909321e+08 +9.58779972e+08 1.40e+03 1.8e+00 1.8e-01 0.569 0.415 0.00
  70 -9.728793985e+08 +9.58756905e+08 1.47e+03 1.7e+00 1.8e-01 0.569 0.415 0.00
  71 -9.728686078e+08 +9.58735323e+08 1.47e+03 1.7e+00 1.8e-01 0.569 0.415 0.00
  72 -9.728585192e+08 +9.58715146e+08 1.46e+03 1.7e+00 1.7e-01 0.569 0.415 0.00
  73 -9.728490903e+08 +9.58696288e+08 1.45e+03 1.6e+00 1.7e-01 0.569 0.415 0.00
  74 -9.728402829e+08 +9.58678673e+08 1.45e+03 1.6e+00 1.7e-01 0.569 0.415 0.00
  75 -9.728320689e+08 +9.58662245e+08 1.43e+03 1.6e+00 1.6e-01 0.569 0.415 0.00
  76 -9.728244054e+08 +9.58646918e+08 1.40e+03 1.5e+00 1.5e-01 0.569 0.415 0.00
  77 -9.728172604e+08 +9.58632628e+08 1.37e+03 1.5e+00 1.4e-01 0.569 0.415 0.00
  78 -9.728106055e+08 +9.58619319e+08 1.27e+03 1.3e+00 1.4e-01 0.569 0.415 0.00
  79 -9.728044109e+08 +9.58606929e+08 1.24e+03 1.3e+00 1.3e-01 0.569 0.415 0.00
  80 -9.727986646e+08 +9.58595437e+08 1.22e+03 1.2e+00 1.3e-01 0.569 0.415 0.00
  81 -9.727933394e+08 +9.58584786e+08 1.19e+03 1.2e+00 1.2e-01 0.569 0.415 0.00
  82 -9.727883934e+08 +9.58574894e+08 1.16e+03 1.2e+00 1.1e-01 0.569 0.415 0.00
  83 -9.727837937e+08 +9.58565695e+08 1.13e+03 1.1e+00 1.0e-01 0.569 0.415 0.00
  84 -9.727795008e+08 +9.58557109e+08 1.11e+03 1.1e+00 9.7e-02 0.569 0.415 0.00
  85 -9.727754799e+08 +9.58549067e+08 1.11e+03 1.1e+00 9.0e-02 0.569 0.415 0.00
  86 -9.727716991e+08 +9.58541506e+08 1.12e+03 1.2e+00 8.3e-02 0.569 0.415 0.00
  87 -9.727681317e+08 +9.58534371e+08 1.14e+03 1.2e+00 7.6e-02 0.570 0.415 0.00
  88 -9.727647444e+08 +9.58527596e+08 1.18e+03 1.3e+00 7.0e-02 0.570 0.415 0.00
  89 -9.727615041e+08 +9.58521116e+08 1.23e+03 1.4e+00 6.4e-02 0.570 0.415 0.00
  90 -9.727583817e+08 +9.58514871e+08 1.30e+03 1.5e+00 5.8e-02 0.570 0.415 0.00
  91 -9.727553485e+08 +9.58508805e+08 1.39e+03 1.6e+00 5.2e-02 0.570 0.415 0.00
  92 -9.727523785e+08 +9.58502865e+08 1.49e+03 1.7e+00 4.8e-02 0.570 0.415 0.00
  93 -9.727495245e+08 +9.58497157e+08 1.62e+03 1.8e+00 4.7e-02 0.570 0.415 0.00
  94 -9.727469540e+08 +9.58492016e+08 1.53e+03 1.7e+00 5.0e-02 0.570 0.415 0.00
  95 -9.727445956e+08 +9.58487299e+08 1.46e+03 1.6e+00 5.1e-02 0.570 0.415 0.00
  96 -9.727424090e+08 +9.58482926e+08 1.42e+03 1.5e+00 5.2e-02 0.570 0.415 0.00
  97 -9.727403690e+08 +9.58478846e+08 1.39e+03 1.4e+00 5.2e-02 0.570 0.415 0.00
  98 -9.727384572e+08 +9.58475022e+08 1.37e+03 1.4e+00 5.2e-02 0.570 0.415 0.00
  99 -9.727366601e+08 +9.58471428e+08 1.36e+03 1.3e+00 5.2e-02 0.570 0.415 0.00
 100 -9.727349674e+08 +9.58468042e+08 1.35e+03 1.3e+00 5.1e-02 0.570 0.416 0.00
Warning message:
Quick-TRANSfer stage steps exceeded maximum (= 922700) 
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".log.indv-cell.int19k.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
722762.42  20339.25 216673.74 
