
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 3"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-3 Poisson NMF to 101000 x 18482 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.198938200e+09 +1.37158392e+09 2.40e+04 1.4e+02 2.1e-01 0.897 0.953 0.00
   2 -1.194523467e+09 +1.36275446e+09 4.84e+03 1.3e+01 1.4e+00 0.899 0.891 0.00
   3 -1.193341213e+09 +1.36038995e+09 2.48e+03 5.7e+00 4.9e-01 0.900 0.910 0.00
   4 -1.192932650e+09 +1.35957282e+09 3.85e+02 4.0e+00 2.7e-01 0.900 0.895 0.00
   5 -1.192715283e+09 +1.35913809e+09 9.87e+02 2.9e+00 1.6e-01 0.902 0.869 0.00
   6 -1.192588592e+09 +1.35888471e+09 2.14e+02 2.2e+00 1.0e-01 0.903 0.850 0.00
   7 -1.192511578e+09 +1.35873068e+09 1.72e+02 1.7e+00 7.5e-02 0.904 0.837 0.00
   8 -1.192463319e+09 +1.35863416e+09 1.40e+02 1.3e+00 5.7e-02 0.905 0.830 0.00
   9 -1.192433086e+09 +1.35857369e+09 1.11e+02 1.1e+00 4.5e-02 0.906 0.827 0.00
  10 -1.192414608e+09 +1.35853674e+09 8.72e+01 8.3e-01 3.5e-02 0.906 0.826 0.00
  11 -1.192403477e+09 +1.35851448e+09 7.22e+01 6.4e-01 2.8e-02 0.907 0.825 0.00
  12 -1.192396720e+09 +1.35850096e+09 5.89e+01 4.9e-01 2.2e-02 0.907 0.824 0.00
  13 -1.192392568e+09 +1.35849266e+09 4.74e+01 3.8e-01 1.7e-02 0.907 0.823 0.00
  14 -1.192390034e+09 +1.35848759e+09 3.77e+01 3.0e-01 1.4e-02 0.908 0.822 0.00
  15 -1.192388498e+09 +1.35848452e+09 2.99e+01 2.3e-01 1.1e-02 0.908 0.822 0.00
  16 -1.192387570e+09 +1.35848266e+09 2.37e+01 1.8e-01 8.5e-03 0.908 0.822 0.00
  17 -1.192387012e+09 +1.35848154e+09 1.87e+01 1.4e-01 6.6e-03 0.908 0.821 0.00
  18 -1.192386676e+09 +1.35848087e+09 1.47e+01 1.1e-01 5.2e-03 0.908 0.821 0.00
  19 -1.192386474e+09 +1.35848047e+09 1.15e+01 8.2e-02 4.0e-03 0.908 0.821 0.00
  20 -1.192386352e+09 +1.35848023e+09 9.03e+00 6.4e-02 3.1e-03 0.908 0.821 0.00
  21 -1.192386279e+09 +1.35848008e+09 7.05e+00 4.9e-02 2.4e-03 0.908 0.821 0.00
  22 -1.192386236e+09 +1.35847999e+09 5.49e+00 3.8e-02 1.9e-03 0.908 0.821 0.00
  23 -1.192386209e+09 +1.35847994e+09 4.27e+00 2.9e-02 1.5e-03 0.908 0.821 0.00
  24 -1.192386193e+09 +1.35847991e+09 3.32e+00 2.3e-02 1.1e-03 0.908 0.821 0.00
  25 -1.192386184e+09 +1.35847989e+09 2.57e+00 1.7e-02 8.8e-04 0.908 0.821 0.00
  26 -1.192386178e+09 +1.35847988e+09 2.00e+00 1.3e-02 6.8e-04 0.908 0.821 0.00
  27 -1.192386175e+09 +1.35847987e+09 1.55e+00 1.0e-02 5.3e-04 0.908 0.821 0.00
  28 -1.192386173e+09 +1.35847987e+09 1.20e+00 8.1e-03 4.1e-04 0.908 0.821 0.00
  29 -1.192386171e+09 +1.35847986e+09 9.27e-01 6.3e-03 3.2e-04 0.908 0.821 0.00
  30 -1.192386170e+09 +1.35847986e+09 7.17e-01 4.9e-03 2.5e-04 0.908 0.821 0.00
  31 -1.192386170e+09 +1.35847986e+09 5.55e-01 3.8e-03 1.9e-04 0.908 0.821 0.00
  32 -1.192386170e+09 +1.35847986e+09 4.30e-01 2.9e-03 1.5e-04 0.908 0.821 0.00
  33 -1.192386169e+09 +1.35847986e+09 3.33e-01 2.3e-03 1.1e-04 0.908 0.821 0.00
  34 -1.192386169e+09 +1.35847986e+09 2.58e-01 1.8e-03 8.9e-05 0.908 0.821 0.00
  35 -1.192386169e+09 +1.35847986e+09 2.01e-01 1.4e-03 7.0e-05 0.908 0.821 0.00
  36 -1.192386169e+09 +1.35847986e+09 1.56e-01 1.1e-03 5.4e-05 0.908 0.821 0.00
  37 -1.192386169e+09 +1.35847986e+09 1.21e-01 8.5e-04 4.2e-05 0.908 0.821 0.00
  38 -1.192386169e+09 +1.35847986e+09 9.44e-02 6.7e-04 3.3e-05 0.908 0.821 0.00
  39 -1.192386169e+09 +1.35847986e+09 7.36e-02 5.2e-04 2.6e-05 0.908 0.821 0.00
  40 -1.192386169e+09 +1.35847986e+09 5.74e-02 4.1e-04 2.0e-05 0.908 0.821 0.00
  41 -1.192386169e+09 +1.35847986e+09 4.47e-02 3.2e-04 1.6e-05 0.908 0.821 0.00
  42 -1.192386169e+09 +1.35847986e+09 3.49e-02 2.5e-04 1.2e-05 0.908 0.821 0.00
  43 -1.192386169e+09 +1.35847986e+09 2.73e-02 2.0e-04 9.9e-06 0.908 0.821 0.00
  44 -1.192386169e+09 +1.35847986e+09 2.14e-02 1.6e-04 8.9e-06 0.908 0.821 0.00
  45 -1.192386169e+09 +1.35847986e+09 1.67e-02 1.2e-04 8.0e-06 0.908 0.821 0.00
  46 -1.192386169e+09 +1.35847986e+09 1.31e-02 9.6e-05 7.2e-06 0.908 0.821 0.00
  47 -1.192386169e+09 +1.35847986e+09 1.03e-02 7.5e-05 6.5e-06 0.908 0.821 0.00
  48 -1.192386169e+09 +1.35847986e+09 8.05e-03 5.9e-05 5.8e-06 0.908 0.821 0.00
  49 -1.192386169e+09 +1.35847986e+09 6.32e-03 4.7e-05 5.2e-06 0.908 0.821 0.00
  50 -1.192386169e+09 +1.35847986e+09 4.96e-03 3.7e-05 4.7e-06 0.908 0.821 0.00
  51 -1.192386169e+09 +1.35847986e+09 3.90e-03 2.9e-05 4.2e-06 0.908 0.821 0.00
  52 -1.192386169e+09 +1.35847986e+09 3.06e-03 2.3e-05 3.8e-06 0.908 0.821 0.00
  53 -1.192386169e+09 +1.35847986e+09 2.56e-03 1.8e-05 3.4e-06 0.908 0.821 0.00
  54 -1.192386169e+09 +1.35847986e+09 2.40e-03 1.4e-05 3.0e-06 0.908 0.821 0.00
  55 -1.192386169e+09 +1.35847986e+09 2.24e-03 1.1e-05 2.7e-06 0.908 0.821 0.00
  56 -1.192386169e+09 +1.35847986e+09 2.07e-03 8.9e-06 2.5e-06 0.908 0.821 0.00
  57 -1.192386169e+09 +1.35847986e+09 1.91e-03 7.0e-06 2.2e-06 0.908 0.821 0.00
  58 -1.192386169e+09 +1.35847986e+09 1.75e-03 5.5e-06 2.0e-06 0.908 0.821 0.00
  59 -1.192386169e+09 +1.35847986e+09 1.61e-03 4.4e-06 1.8e-06 0.908 0.821 0.00
  60 -1.192386169e+09 +1.35847986e+09 1.47e-03 3.5e-06 1.6e-06 0.908 0.821 0.00
  61 -1.192386169e+09 +1.35847986e+09 1.34e-03 2.7e-06 1.4e-06 0.908 0.821 0.00
  62 -1.192386169e+09 +1.35847986e+09 1.21e-03 2.2e-06 1.3e-06 0.908 0.821 0.00
  63 -1.192386169e+09 +1.35847986e+09 1.10e-03 1.7e-06 1.1e-06 0.908 0.821 0.00
  64 -1.192386169e+09 +1.35847986e+09 9.98e-04 1.4e-06 1.0e-06 0.908 0.821 0.00
  65 -1.192386169e+09 +1.35847986e+09 9.04e-04 1.1e-06 9.2e-07 0.908 0.821 0.00
  66 -1.192386169e+09 +1.35847986e+09 8.17e-04 9.3e-07 8.3e-07 0.908 0.821 0.00
  67 -1.192386169e+09 +1.35847986e+09 7.38e-04 7.6e-07 7.4e-07 0.908 0.821 0.00
  68 -1.192386169e+09 +1.35847986e+09 6.67e-04 6.3e-07 6.7e-07 0.908 0.821 0.00
  69 -1.192386169e+09 +1.35847986e+09 6.12e-04 5.2e-07 6.0e-07 0.908 0.821 0.00
  70 -1.192386169e+09 +1.35847986e+09 6.12e-04 4.3e-07 5.4e-07 0.908 0.821 0.00
  71 -1.192386169e+09 +1.35847986e+09 6.12e-04 3.6e-07 4.8e-07 0.908 0.821 0.00
  72 -1.192386169e+09 +1.35847986e+09 6.12e-04 3.0e-07 4.3e-07 0.908 0.821 0.00
  73 -1.192386169e+09 +1.35847986e+09 6.12e-04 2.5e-07 3.9e-07 0.908 0.821 0.00
  74 -1.192386169e+09 +1.35847986e+09 6.12e-04 2.1e-07 3.5e-07 0.908 0.821 0.00
  75 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.8e-07 3.1e-07 0.908 0.821 0.00
  76 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.5e-07 2.8e-07 0.908 0.821 0.00
  77 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.3e-07 2.5e-07 0.908 0.821 0.00
  78 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.1e-07 2.2e-07 0.908 0.821 0.00
  79 -1.192386169e+09 +1.35847986e+09 6.12e-04 9.6e-08 2.0e-07 0.908 0.821 0.00
  80 -1.192386169e+09 +1.35847986e+09 6.12e-04 8.3e-08 1.8e-07 0.908 0.821 0.00
  81 -1.192386169e+09 +1.35847986e+09 6.12e-04 7.1e-08 1.6e-07 0.908 0.821 0.00
  82 -1.192386169e+09 +1.35847986e+09 6.12e-04 6.2e-08 1.5e-07 0.908 0.821 0.00
  83 -1.192386169e+09 +1.35847986e+09 6.12e-04 5.4e-08 1.3e-07 0.908 0.821 0.00
  84 -1.192386169e+09 +1.35847986e+09 6.12e-04 4.7e-08 1.2e-07 0.908 0.821 0.00
  85 -1.192386169e+09 +1.35847986e+09 6.12e-04 4.1e-08 1.1e-07 0.908 0.821 0.00
  86 -1.192386169e+09 +1.35847986e+09 6.12e-04 3.6e-08 9.4e-08 0.908 0.821 0.00
  87 -1.192386169e+09 +1.35847986e+09 6.12e-04 3.1e-08 8.4e-08 0.908 0.821 0.00
  88 -1.192386169e+09 +1.35847986e+09 6.12e-04 2.8e-08 7.6e-08 0.908 0.821 0.00
  89 -1.192386169e+09 +1.35847986e+09 6.12e-04 2.4e-08 6.8e-08 0.908 0.821 0.00
  90 -1.192386169e+09 +1.35847986e+09 6.12e-04 2.2e-08 6.1e-08 0.908 0.821 0.00
  91 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.9e-08 5.5e-08 0.908 0.821 0.00
  92 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.7e-08 4.9e-08 0.908 0.821 0.00
  93 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.5e-08 4.4e-08 0.908 0.821 0.00
  94 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.3e-08 3.9e-08 0.908 0.821 0.00
  95 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.2e-08 3.5e-08 0.908 0.821 0.00
  96 -1.192386169e+09 +1.35847986e+09 6.12e-04 1.0e-08 3.2e-08 0.908 0.821 0.00
  97 -1.192386169e+09 +1.35847986e+09 6.12e-04 9.3e-09 2.8e-08 0.908 0.821 0.00
  98 -1.192386169e+09 +1.35847986e+09 6.12e-04 8.3e-09 2.6e-08 0.908 0.821 0.00
  99 -1.192386169e+09 +1.35847986e+09 6.12e-04 7.4e-09 2.3e-08 0.908 0.821 0.00
 100 -1.192386169e+09 +1.35847986e+09 6.12e-04 6.6e-09 2.1e-08 0.908 0.821 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
53386.487  7911.821 36628.677 
