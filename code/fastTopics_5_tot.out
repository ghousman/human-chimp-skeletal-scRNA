
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Read in command line arguments as list of character vectors
> args=(commandArgs(TRUE))
> 
> #Check if arguments are passed and cycle through to evaluate each element
> if(length(args)==0){
+   print("No arguments supplied.")
+   #supply default values
+   clustnum=3
+   data.source="tot"
+ }else{
+   for(i in 1:length(args)){
+     eval(parse(text=args[[i]]))
+   }
+ }
> print(paste0("k: ",clustnum))
[1] "k: 5"
> print(paste0("data source: ",data.source))
[1] "data source: tot"
> 
> #Load libraries
> library(Seurat)
> library(CountClust)
Loading required package: ggplot2
> library(classtpx)
Loading required package: slam
> library(fastTopics)
> 
> #Load data
> scrna <- paste0("../data/cellranger-data-full/data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds")
> data <- readRDS(scrna)
> 
> #Prepare data (unintegrated count data)
> counts <- as.matrix(data@assays$RNA@counts) #do not use integrated data
> counts <- counts[rowSums(counts>0)>0,]      #remove genes with 0 counts across cells
> counts <- t(as.matrix(counts))              #fix matrix orientation (barcodes x features)
> rm(data)
> 
> #Fit fastTopics model and save data
> fit <- fit_poisson_nmf(counts, k=clustnum, numiter=100)
Using 4 RcppParallel threads.
Initializing factors using Topic SCORE algorithm.
Initializing loadings by running 10 SCD updates.
Using 4 RcppParallel threads.
Fitting rank-5 Poisson NMF to 101000 x 18482 dense matrix.
Running 100 SCD updates, without extrapolation (fastTopics 0.3-185).
iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
   1 -1.168691655e+09 +1.31109083e+09 5.04e+04 2.1e+02 1.3e+00 0.814 0.777 0.00
   2 -1.161981647e+09 +1.29767082e+09 2.56e+03 6.7e+01 2.7e+00 0.836 0.831 0.00
   3 -1.159531453e+09 +1.29277043e+09 1.71e+04 4.2e+01 1.9e+00 0.840 0.826 0.00
   4 -1.158200621e+09 +1.29010876e+09 8.09e+02 2.8e+01 1.4e+00 0.847 0.795 0.00
   5 -1.157578807e+09 +1.28886514e+09 8.16e+02 1.7e+01 5.3e-01 0.849 0.788 0.00
   6 -1.157318533e+09 +1.28834459e+09 4.13e+02 1.0e+01 3.1e-01 0.849 0.763 0.00
   7 -1.157162661e+09 +1.28803284e+09 3.62e+02 6.3e+00 2.2e-01 0.850 0.753 0.00
   8 -1.157047957e+09 +1.28780344e+09 4.43e+02 5.6e+00 1.7e-01 0.850 0.747 0.00
   9 -1.156954460e+09 +1.28761644e+09 6.14e+02 5.0e+00 1.6e-01 0.850 0.744 0.00
  10 -1.156873931e+09 +1.28745538e+09 6.82e+02 4.4e+00 1.4e-01 0.850 0.742 0.00
  11 -1.156802614e+09 +1.28731275e+09 5.98e+02 3.9e+00 1.3e-01 0.849 0.741 0.00
  12 -1.156738598e+09 +1.28718472e+09 4.28e+02 3.4e+00 1.3e-01 0.849 0.740 0.00
  13 -1.156680704e+09 +1.28706893e+09 2.70e+02 3.0e+00 1.2e-01 0.848 0.740 0.00
  14 -1.156628061e+09 +1.28696364e+09 2.14e+02 2.8e+00 1.1e-01 0.847 0.740 0.00
  15 -1.156580016e+09 +1.28686755e+09 2.06e+02 2.9e+00 9.9e-02 0.846 0.740 0.00
  16 -1.156536418e+09 +1.28678036e+09 1.99e+02 3.0e+00 8.9e-02 0.845 0.741 0.00
  17 -1.156497098e+09 +1.28670172e+09 1.96e+02 3.0e+00 8.7e-02 0.844 0.741 0.00
  18 -1.156461624e+09 +1.28663077e+09 1.96e+02 3.0e+00 8.5e-02 0.843 0.742 0.00
  19 -1.156429627e+09 +1.28656678e+09 1.94e+02 3.0e+00 8.3e-02 0.842 0.743 0.00
  20 -1.156400888e+09 +1.28650930e+09 1.90e+02 2.9e+00 8.1e-02 0.841 0.743 0.00
  21 -1.156375185e+09 +1.28645789e+09 1.84e+02 2.9e+00 7.9e-02 0.839 0.744 0.00
  22 -1.156352337e+09 +1.28641219e+09 1.76e+02 2.8e+00 7.6e-02 0.839 0.745 0.00
  23 -1.156332058e+09 +1.28637164e+09 1.66e+02 2.7e+00 7.4e-02 0.837 0.745 0.00
  24 -1.156314042e+09 +1.28633561e+09 1.57e+02 2.6e+00 7.1e-02 0.836 0.746 0.00
  25 -1.156297952e+09 +1.28630343e+09 1.49e+02 2.4e+00 6.8e-02 0.835 0.747 0.00
  26 -1.156283551e+09 +1.28627462e+09 1.40e+02 2.3e+00 6.5e-02 0.834 0.747 0.00
  27 -1.156270656e+09 +1.28624883e+09 1.31e+02 2.2e+00 6.3e-02 0.834 0.748 0.00
  28 -1.156259112e+09 +1.28622575e+09 1.21e+02 2.1e+00 6.0e-02 0.833 0.748 0.00
  29 -1.156248996e+09 +1.28620551e+09 1.10e+02 2.0e+00 5.6e-02 0.832 0.749 0.00
  30 -1.156239873e+09 +1.28618727e+09 1.00e+02 1.8e+00 5.2e-02 0.831 0.749 0.00
  31 -1.156231982e+09 +1.28617149e+09 9.08e+01 1.7e+00 4.8e-02 0.831 0.750 0.00
  32 -1.156225103e+09 +1.28615773e+09 9.49e+01 1.5e+00 4.5e-02 0.830 0.750 0.00
  33 -1.156219080e+09 +1.28614568e+09 1.02e+02 1.4e+00 4.1e-02 0.830 0.751 0.00
  34 -1.156213814e+09 +1.28613515e+09 1.09e+02 1.3e+00 3.8e-02 0.829 0.751 0.00
  35 -1.156209233e+09 +1.28612599e+09 1.15e+02 1.2e+00 3.5e-02 0.828 0.751 0.00
  36 -1.156205259e+09 +1.28611804e+09 1.19e+02 1.1e+00 3.2e-02 0.828 0.752 0.00
  37 -1.156201819e+09 +1.28611116e+09 1.23e+02 9.9e-01 3.0e-02 0.828 0.752 0.00
  38 -1.156198844e+09 +1.28610521e+09 1.25e+02 9.0e-01 2.7e-02 0.827 0.752 0.00
  39 -1.156196275e+09 +1.28610007e+09 1.26e+02 8.2e-01 2.5e-02 0.827 0.753 0.00
  40 -1.156194058e+09 +1.28609564e+09 1.27e+02 7.5e-01 2.3e-02 0.826 0.753 0.00
  41 -1.156192153e+09 +1.28609183e+09 1.26e+02 6.8e-01 2.1e-02 0.826 0.753 0.00
  42 -1.156190518e+09 +1.28608856e+09 1.25e+02 6.2e-01 1.9e-02 0.826 0.754 0.00
  43 -1.156189118e+09 +1.28608576e+09 1.22e+02 5.7e-01 1.7e-02 0.825 0.754 0.00
  44 -1.156187922e+09 +1.28608337e+09 1.19e+02 5.3e-01 1.6e-02 0.825 0.754 0.00
  45 -1.156186902e+09 +1.28608133e+09 1.15e+02 4.9e-01 1.4e-02 0.825 0.754 0.00
  46 -1.156186035e+09 +1.28607959e+09 1.11e+02 4.6e-01 1.3e-02 0.825 0.754 0.00
  47 -1.156185299e+09 +1.28607812e+09 1.07e+02 4.2e-01 1.2e-02 0.825 0.755 0.00
  48 -1.156184675e+09 +1.28607687e+09 1.02e+02 3.9e-01 1.1e-02 0.824 0.755 0.00
  49 -1.156184148e+09 +1.28607582e+09 9.67e+01 3.6e-01 9.7e-03 0.824 0.755 0.00
  50 -1.156183703e+09 +1.28607493e+09 9.15e+01 3.3e-01 8.8e-03 0.824 0.755 0.00
  51 -1.156183327e+09 +1.28607418e+09 8.63e+01 3.0e-01 8.0e-03 0.824 0.755 0.00
  52 -1.156183011e+09 +1.28607354e+09 8.11e+01 2.8e-01 7.3e-03 0.824 0.755 0.00
  53 -1.156182745e+09 +1.28607301e+09 7.60e+01 2.5e-01 6.6e-03 0.824 0.755 0.00
  54 -1.156182522e+09 +1.28607256e+09 7.11e+01 2.3e-01 6.0e-03 0.823 0.756 0.00
  55 -1.156182334e+09 +1.28607219e+09 6.63e+01 2.1e-01 5.4e-03 0.823 0.756 0.00
  56 -1.156182176e+09 +1.28607187e+09 6.16e+01 1.9e-01 4.9e-03 0.823 0.756 0.00
  57 -1.156182044e+09 +1.28607161e+09 5.72e+01 1.8e-01 4.5e-03 0.823 0.756 0.00
  58 -1.156181933e+09 +1.28607139e+09 5.30e+01 1.6e-01 4.1e-03 0.823 0.756 0.00
  59 -1.156181840e+09 +1.28607120e+09 4.90e+01 1.5e-01 3.7e-03 0.823 0.756 0.00
  60 -1.156181762e+09 +1.28607105e+09 4.53e+01 1.3e-01 3.3e-03 0.823 0.756 0.00
  61 -1.156181697e+09 +1.28607091e+09 4.18e+01 1.2e-01 3.0e-03 0.823 0.756 0.00
  62 -1.156181642e+09 +1.28607081e+09 3.86e+01 1.1e-01 2.7e-03 0.823 0.756 0.00
  63 -1.156181596e+09 +1.28607071e+09 3.55e+01 1.0e-01 2.5e-03 0.823 0.756 0.00
  64 -1.156181557e+09 +1.28607064e+09 3.27e+01 9.3e-02 2.2e-03 0.823 0.756 0.00
  65 -1.156181525e+09 +1.28607057e+09 3.00e+01 8.4e-02 2.0e-03 0.823 0.756 0.00
  66 -1.156181498e+09 +1.28607052e+09 2.76e+01 7.7e-02 1.8e-03 0.823 0.756 0.00
  67 -1.156181475e+09 +1.28607047e+09 2.53e+01 7.0e-02 1.7e-03 0.823 0.756 0.00
  68 -1.156181456e+09 +1.28607043e+09 2.32e+01 6.4e-02 1.5e-03 0.823 0.756 0.00
  69 -1.156181440e+09 +1.28607040e+09 2.13e+01 5.8e-02 1.4e-03 0.823 0.756 0.00
  70 -1.156181426e+09 +1.28607037e+09 1.95e+01 5.3e-02 1.2e-03 0.823 0.756 0.00
  71 -1.156181415e+09 +1.28607035e+09 1.79e+01 4.8e-02 1.1e-03 0.822 0.756 0.00
  72 -1.156181405e+09 +1.28607033e+09 1.64e+01 4.3e-02 1.0e-03 0.822 0.756 0.00
  73 -1.156181397e+09 +1.28607032e+09 1.50e+01 4.0e-02 9.3e-04 0.822 0.757 0.00
  74 -1.156181390e+09 +1.28607030e+09 1.37e+01 3.6e-02 8.5e-04 0.822 0.757 0.00
  75 -1.156181385e+09 +1.28607029e+09 1.26e+01 3.3e-02 7.7e-04 0.822 0.757 0.00
  76 -1.156181380e+09 +1.28607028e+09 1.15e+01 3.0e-02 7.0e-04 0.822 0.757 0.00
  77 -1.156181376e+09 +1.28607027e+09 1.05e+01 2.7e-02 6.3e-04 0.822 0.757 0.00
  78 -1.156181373e+09 +1.28607027e+09 9.63e+00 2.5e-02 5.8e-04 0.822 0.757 0.00
  79 -1.156181370e+09 +1.28607026e+09 8.81e+00 2.2e-02 5.4e-04 0.822 0.757 0.00
  80 -1.156181367e+09 +1.28607026e+09 8.06e+00 2.0e-02 5.0e-04 0.822 0.757 0.00
  81 -1.156181365e+09 +1.28607025e+09 7.38e+00 1.9e-02 4.7e-04 0.822 0.757 0.00
  82 -1.156181364e+09 +1.28607025e+09 6.75e+00 1.7e-02 4.3e-04 0.822 0.757 0.00
  83 -1.156181362e+09 +1.28607025e+09 6.18e+00 1.5e-02 4.0e-04 0.822 0.757 0.00
  84 -1.156181361e+09 +1.28607024e+09 5.65e+00 1.4e-02 3.8e-04 0.822 0.757 0.00
  85 -1.156181360e+09 +1.28607024e+09 5.18e+00 1.3e-02 3.5e-04 0.822 0.757 0.00
  86 -1.156181359e+09 +1.28607024e+09 4.74e+00 1.2e-02 3.2e-04 0.822 0.757 0.00
  87 -1.156181358e+09 +1.28607024e+09 4.34e+00 1.1e-02 3.0e-04 0.822 0.757 0.00
  88 -1.156181358e+09 +1.28607024e+09 3.97e+00 9.7e-03 2.8e-04 0.822 0.757 0.00
  89 -1.156181357e+09 +1.28607024e+09 3.64e+00 8.8e-03 2.6e-04 0.822 0.757 0.00
  90 -1.156181357e+09 +1.28607023e+09 3.33e+00 8.0e-03 2.4e-04 0.822 0.757 0.00
  91 -1.156181356e+09 +1.28607023e+09 3.05e+00 7.3e-03 2.2e-04 0.822 0.757 0.00
  92 -1.156181356e+09 +1.28607023e+09 2.80e+00 6.7e-03 2.1e-04 0.822 0.757 0.00
  93 -1.156181356e+09 +1.28607023e+09 2.56e+00 6.1e-03 1.9e-04 0.822 0.757 0.00
  94 -1.156181355e+09 +1.28607023e+09 2.35e+00 5.6e-03 1.8e-04 0.822 0.757 0.00
  95 -1.156181355e+09 +1.28607023e+09 2.15e+00 5.1e-03 1.7e-04 0.822 0.757 0.00
  96 -1.156181355e+09 +1.28607023e+09 1.97e+00 4.6e-03 1.5e-04 0.822 0.757 0.00
  97 -1.156181355e+09 +1.28607023e+09 1.81e+00 4.2e-03 1.4e-04 0.822 0.757 0.00
  98 -1.156181355e+09 +1.28607023e+09 1.66e+00 3.9e-03 1.3e-04 0.822 0.757 0.00
  99 -1.156181355e+09 +1.28607023e+09 1.52e+00 3.5e-03 1.2e-04 0.822 0.757 0.00
 100 -1.156181355e+09 +1.28607023e+09 1.40e+00 3.2e-03 1.1e-04 0.822 0.757 0.00
> saveRDS(fit, file=paste0("../data/gom-data/topics",clustnum,".data.filterC.log.indv-cell.intNo0.reg-",data.source,".rds"))
> 
> proc.time()
     user    system   elapsed 
74289.565  8430.704 41694.335 
